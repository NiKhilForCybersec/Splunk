<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Inputs (HEC, Forwarders, APIs) | Splunk Reference</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <div class="app-container">
                    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <a href="../index.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit;">
            <div class="sidebar-logo-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            </div>
            <div class="sidebar-logo-text">
              <h1>Splunk Reference</h1>
              <span>Log & Detection Engineering</span>
            </div>
          </a>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Getting Started</div>
          <a href="../index.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span>Command Center</span></a>
          <a href="day1.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/></svg><span>Day 1 Checklist</span></a>
          <a href="professional-excellence.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg><span>Professional Excellence</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Splunk Platform</div>
          <a href="splunk-fundamentals.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>Splunk 101</span></a>
          <a href="splunk-architecture.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg><span>Architecture Deep Dive</span></a>
          <a href="splunk-apps.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg><span>Apps & Add-ons</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Log Engineering</div>
          <a href="log-onboarding.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span>Log Onboarding Guide</span></a>
          <a href="data-inputs.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg><span>Data Inputs (HEC/UF)</span></a>
          <a href="props-transforms.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg><span>props.conf & transforms</span></a>
          <a href="parsing-cim.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg><span>CIM Compliance</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">SPL Mastery</div>
          <a href="splunk-howto.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg><span>SPL Fundamentals</span></a>
          <a href="spl-reference.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg><span>SPL Reference Card</span></a>
          <a href="lookups.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg><span>Lookups Deep Dive</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Enterprise Security</div>
          <a href="splunk-es.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>ES Overview</span></a>
          <a href="correlation-searches.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><span>Correlation Searches</span></a>
          <a href="detection-lifecycle.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg><span>Detection Lifecycle</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Data Sources</div>
          <a href="vendor-akamai.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>Akamai WAF</span></a>
          <a href="vendor-cyberark.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><span>CyberArk Identity</span></a>
          <a href="vendor-entra.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg><span>Entra ID / Azure AD</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Active Projects</div>
          <a href="waf-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span>WAF/DDoS Project</span></a>
          <a href="waf-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>WAF Use Cases</span></a>
          <a href="mfa-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><span>MFA Project</span></a>
          <a href="mfa-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>MFA Use Cases</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="splunk-ops.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/></svg><span>Splunk Cloud Admin</span></a>
          <a href="troubleshooting.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>Troubleshooting</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Reference</div>
          <a href="decision-trees.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="3"/><line x1="12" y1="8" x2="12" y2="14"/><circle cx="6" cy="19" r="3"/><circle cx="18" cy="19" r="3"/></svg><span>Decision Trees</span></a>
          <a href="runbooks.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>SOC Runbooks</span></a>
          <a href="cheat-sheets.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="3" x2="9" y2="21"/></svg><span>Cheat Sheets</span></a>
        </div>
      </nav>
      <div class="sidebar-footer"><p>Log & Detection Engineering v3.0</p></div>
    </aside>
    
    <main class="main-content">
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" aria-label="Toggle menu"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
          <div class="breadcrumb">
            <a href="../index.html" class="breadcrumb-item">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item current">Data Inputs</span>
          </div>
        </div>
      </header>

      <div class="page-content">
        <div class="section">
          <h1 class="section-title">Data Inputs Deep Dive</h1>
          <p class="section-subtitle">Complete guide to HTTP Event Collector (HEC), Universal Forwarders, and other data input methods</p>
        </div>

        <!-- Input Method Selection -->
        <div class="section">
          <h2 class="subsection-title">Choosing the Right Input Method</h2>
          
          <div class="card" style="padding:24px;">
            <table class="reference-table">
              <thead>
                <tr>
                  <th>Input Method</th>
                  <th>Best For</th>
                  <th>Protocol</th>
                  <th>Pros</th>
                  <th>Cons</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>HEC</strong></td>
                  <td>Cloud services, APIs, containers</td>
                  <td>HTTPS</td>
                  <td>Easy setup, token-based auth, no agent</td>
                  <td>Application must support HTTP push</td>
                </tr>
                <tr>
                  <td><strong>Universal Forwarder</strong></td>
                  <td>File monitoring, Windows Events</td>
                  <td>TCP/TLS</td>
                  <td>Reliable, buffering, lightweight</td>
                  <td>Requires agent installation</td>
                </tr>
                <tr>
                  <td><strong>Heavy Forwarder</strong></td>
                  <td>Syslog aggregation, data transformation</td>
                  <td>TCP/UDP/TLS</td>
                  <td>Can parse/filter/route before sending</td>
                  <td>Higher resource usage</td>
                </tr>
                <tr>
                  <td><strong>Syslog</strong></td>
                  <td>Network devices, Linux servers</td>
                  <td>UDP/TCP</td>
                  <td>Universal support</td>
                  <td>UDP is unreliable</td>
                </tr>
                <tr>
                  <td><strong>Scripted/Modular Input</strong></td>
                  <td>APIs, databases, custom sources</td>
                  <td>Varies</td>
                  <td>Flexible, pull-based</td>
                  <td>Requires development</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- HEC Section -->
        <div class="section">
          <h2 class="subsection-title">HTTP Event Collector (HEC) — Complete Guide</h2>
          
          <div class="callout info">
            <div class="callout-content">
              <div class="callout-title">Why HEC is Preferred for Cloud</div>
              <div class="callout-body">
                HEC is the recommended method for cloud services because it requires no agent, uses standard HTTPS, works through firewalls, and scales horizontally. Most cloud vendors (AWS, Azure, Akamai, etc.) have native HEC support.
              </div>
            </div>
          </div>

          <h3>Step 1: Enable HEC Globally</h3>
          <div class="card" style="padding:20px;margin-bottom:16px;">
            <ol>
              <li>Navigate to <strong>Settings → Data Inputs</strong></li>
              <li>Click <strong>HTTP Event Collector</strong></li>
              <li>Click <strong>Global Settings</strong> (top right)</li>
              <li>Set <strong>All Tokens: Enabled</strong></li>
              <li>Set <strong>Enable SSL: Checked</strong></li>
              <li>HTTP Port Number: <code>8088</code> (default) or <code>443</code> for cloud</li>
              <li>Click <strong>Save</strong></li>
            </ol>
          </div>

          <h3>Step 2: Create HEC Token</h3>
          <div class="card" style="padding:20px;margin-bottom:16px;">
            <ol>
              <li>Click <strong>New Token</strong></li>
              <li>Configure:
                <table class="reference-table" style="margin:12px 0;">
                  <tr><td><strong>Name</strong></td><td>Descriptive name (e.g., <code>akamai_waf_prod</code>)</td></tr>
                  <tr><td><strong>Source Type</strong></td><td>Select or specify (e.g., <code>akamai:siem</code>)</td></tr>
                  <tr><td><strong>App Context</strong></td><td>App to associate (e.g., <code>Splunk_TA_Akamai</code>)</td></tr>
                  <tr><td><strong>Index</strong></td><td>Default index for this token</td></tr>
                  <tr><td><strong>Source</strong></td><td>Optional - can override per event</td></tr>
                </table>
              </li>
              <li>Click <strong>Review</strong>, then <strong>Submit</strong></li>
              <li><span class="badge" style="background:var(--error-500);">CRITICAL</span> Copy the token immediately — you cannot view it again!</li>
            </ol>
          </div>

          <h3>HEC Endpoint URLs</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;margin-bottom:16px;">
# Splunk Cloud Endpoint
https://http-inputs-<STACK_NAME>.splunkcloud.com:443/services/collector/event

# Single Event
POST /services/collector/event
Authorization: Splunk <YOUR_TOKEN>
Content-Type: application/json

# Multiple Events (batch)
POST /services/collector/event
# Send newline-delimited JSON objects

# Raw Data
POST /services/collector/raw?sourcetype=mysourcetype&index=myindex
# Send raw data in body
          </code>

          <h3>HEC Payload Formats</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;margin-bottom:16px;">
# Single Event with Metadata
{
  "time": 1704067200,
  "host": "webserver01",
  "source": "access.log",
  "sourcetype": "access_combined",
  "index": "web",
  "event": "127.0.0.1 - - [01/Jan/2024:00:00:00 +0000] \"GET / HTTP/1.1\" 200 1234"
}

# Structured Event (JSON payload)
{
  "time": 1704067200,
  "host": "appserver",
  "sourcetype": "myapp:json",
  "index": "application",
  "event": {
    "user": "jsmith",
    "action": "login",
    "status": "success",
    "src_ip": "10.1.2.3"
  }
}

# Batch Format (newline-delimited)
{"time": 1704067200, "event": "event1"}
{"time": 1704067201, "event": "event2"}
{"time": 1704067202, "event": "event3"}
          </code>

          <h3>Testing HEC with curl</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;margin-bottom:16px;">
# Basic test
curl -k "https://http-inputs-STACK.splunkcloud.com:443/services/collector/event" \
  -H "Authorization: Splunk YOUR_TOKEN_HERE" \
  -d '{"event": "Hello from curl test", "sourcetype": "test"}'

# Expected response:
{"text":"Success","code":0}

# Test with specific index and sourcetype
curl -k "https://http-inputs-STACK.splunkcloud.com:443/services/collector/event" \
  -H "Authorization: Splunk YOUR_TOKEN_HERE" \
  -H "Content-Type: application/json" \
  -d '{
    "index": "main",
    "sourcetype": "manual_test",
    "host": "testhost",
    "event": {"test": "data", "timestamp": "2024-01-01T00:00:00Z"}
  }'
          </code>

          <h3>HEC Troubleshooting</h3>
          <table class="reference-table">
            <thead>
              <tr>
                <th>Error Code</th>
                <th>Meaning</th>
                <th>Solution</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>0</code></td>
                <td>Success</td>
                <td>Event accepted</td>
              </tr>
              <tr>
                <td><code>1</code></td>
                <td>Token disabled</td>
                <td>Enable token in Settings → Data Inputs → HEC</td>
              </tr>
              <tr>
                <td><code>2</code></td>
                <td>Token required</td>
                <td>Add Authorization header</td>
              </tr>
              <tr>
                <td><code>3</code></td>
                <td>Invalid authorization</td>
                <td>Check token value is correct</td>
              </tr>
              <tr>
                <td><code>4</code></td>
                <td>Invalid token</td>
                <td>Token doesn't exist - create new token</td>
              </tr>
              <tr>
                <td><code>5</code></td>
                <td>No data</td>
                <td>Request body is empty</td>
              </tr>
              <tr>
                <td><code>6</code></td>
                <td>Invalid data format</td>
                <td>Check JSON syntax</td>
              </tr>
              <tr>
                <td><code>7</code></td>
                <td>Incorrect index</td>
                <td>Token not authorized for that index</td>
              </tr>
              <tr>
                <td><code>10</code></td>
                <td>Data channel missing</td>
                <td>Add channel parameter for indexer acknowledgment</td>
              </tr>
              <tr>
                <td><code>14</code></td>
                <td>Event field required</td>
                <td>JSON must have "event" key</td>
              </tr>
            </tbody>
          </table>

          <h3>HEC Token Management SPL</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;">
# List all HEC tokens
| rest /services/data/inputs/http | table name disabled index sourcetype

# Check HEC input health
index=_internal sourcetype=splunkd component=HttpInputDataHandler 
| stats count by log_level, message | sort -count

# Monitor HEC throughput
index=_internal sourcetype=splunkd HttpInputDataHandler 
| timechart span=1m count by host
          </code>
        </div>

        <!-- Universal Forwarder Section -->
        <div class="section">
          <h2 class="subsection-title">Universal Forwarder (UF)</h2>
          
          <h3>Installation (Linux)</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;margin-bottom:16px;">
# Download from Splunk
wget -O splunkforwarder.tgz "https://download.splunk.com/products/universalforwarder/releases/9.1.0/linux/splunkforwarder-9.1.0-linux-x86_64.tgz"

# Extract
tar -xzf splunkforwarder.tgz -C /opt

# Start and accept license
/opt/splunkforwarder/bin/splunk start --accept-license

# Enable boot start
/opt/splunkforwarder/bin/splunk enable boot-start

# Set admin credentials
/opt/splunkforwarder/bin/splunk edit user admin -password 'NewPassword' -auth admin:changeme
          </code>

          <h3>Configuration Files Location</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;margin-bottom:16px;">
/opt/splunkforwarder/etc/system/local/
├── inputs.conf      # What data to collect
├── outputs.conf     # Where to send data
├── deploymentclient.conf  # Deployment server settings
└── server.conf      # Server settings
          </code>

          <h3>outputs.conf — Sending to Splunk Cloud</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;margin-bottom:16px;">
# /opt/splunkforwarder/etc/system/local/outputs.conf

[tcpout]
defaultGroup = splunkcloud

[tcpout:splunkcloud]
server = inputs1.STACK.splunkcloud.com:9997,inputs2.STACK.splunkcloud.com:9997

# SSL configuration (get certs from Splunk Cloud)
sslCertPath = $SPLUNK_HOME/etc/auth/server.pem
sslRootCAPath = $SPLUNK_HOME/etc/auth/cacert.pem
sslPassword = password
sslVerifyServerCert = true

# Queue settings for reliability
maxQueueSize = 500MB
          </code>

          <h3>inputs.conf — Common Examples</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;margin-bottom:16px;">
# /opt/splunkforwarder/etc/system/local/inputs.conf

# Monitor a directory
[monitor:///var/log/application/*.log]
disabled = false
sourcetype = myapp:log
index = application
# Follow file rotation
followTail = 0

# Monitor with blacklist
[monitor:///var/log]
disabled = false
blacklist = \.(gz|zip|tar)$
sourcetype = syslog
index = os

# Windows Event Logs
[WinEventLog://Security]
disabled = false
index = wineventlog
sourcetype = WinEventLog:Security

[WinEventLog://System]
disabled = false
index = wineventlog
sourcetype = WinEventLog:System

# Scripted input (run command)
[script://./bin/mycheck.sh]
disabled = false
interval = 300
sourcetype = mycheck
index = scripts
          </code>

          <h3>Forwarder Management SPL</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;">
# List all forwarders
| rest /services/deployment/server/clients 
| table clientName, hostname, ip, lastPhoneHomeTime

# Check forwarder versions
index=_internal sourcetype=splunkd group=tcpin_connections 
| stats latest(version) as version, latest(fwdType) as type by hostname

# Forwarder data throughput
index=_internal sourcetype=splunkd group=tcpin_connections 
| timechart span=1h sum(kb) as KB by hostname

# Check for stale forwarders (no data in 24h)
| rest /services/deployment/server/clients 
| eval hours_since_checkin = round((now() - strptime(lastPhoneHomeTime, "%Y-%m-%dT%H:%M:%S")) / 3600, 1)
| where hours_since_checkin > 24
| table clientName, hostname, hours_since_checkin
          </code>
        </div>

        <!-- Syslog Section -->
        <div class="section">
          <h2 class="subsection-title">Syslog Input</h2>
          
          <div class="callout warning">
            <div class="callout-content">
              <div class="callout-title">Syslog in Splunk Cloud</div>
              <div class="callout-body">
                Splunk Cloud doesn't accept direct syslog. Use a Heavy Forwarder or syslog-to-HEC converter as an intermediary.
              </div>
            </div>
          </div>

          <h3>Heavy Forwarder Syslog Configuration</h3>
          <code style="display:block;padding:15px;background:var(--gray-900);color:var(--gray-100);border-radius:8px;overflow-x:auto;white-space:pre;">
# inputs.conf on Heavy Forwarder

# UDP Syslog (unreliable but common)
[udp://514]
disabled = false
sourcetype = syslog
index = network
connection_host = dns

# TCP Syslog (reliable)
[tcp://514]
disabled = false
sourcetype = syslog
index = network
connection_host = dns

# TLS Syslog (secure)
[tcp-ssl://6514]
disabled = false
sourcetype = syslog
index = network
serverCert = $SPLUNK_HOME/etc/auth/server.pem
requireClientCert = false
          </code>
        </div>

        <!-- Input Comparison Summary -->
        <div class="section">
          <h2 class="subsection-title">Input Method Decision Tree</h2>
          
          <div class="card" style="padding:24px;margin-bottom:24px;background:var(--gray-50);overflow-x:auto;">
            <div class="mermaid">
flowchart TD
    A[Where is data source?] --> B{Cloud Service?}
    B -->|Yes| C{Has HEC support?}
    C -->|Yes| D[Use HEC]
    C -->|No| E{Has API?}
    E -->|Yes| F[Scripted/Modular Input or TA]
    E -->|No| G[Check vendor documentation]
    
    B -->|No| H{On-premises server?}
    H -->|Yes| I{File-based logs?}
    I -->|Yes| J[Universal Forwarder]
    I -->|No| K{Syslog?}
    K -->|Yes| L[Heavy Forwarder with syslog input]
    K -->|No| M[Windows Events?]
    M -->|Yes| N[Universal Forwarder with WinEventLog]
    M -->|No| O[Custom scripted input]
    
    H -->|No| P{Network device?}
    P -->|Yes| Q[Heavy Forwarder with syslog]
    P -->|No| R[Evaluate custom solution]
    
    style D fill:#10b981,color:#fff
    style J fill:#3b82f6,color:#fff
    style L fill:#f59e0b,color:#fff
    style N fill:#3b82f6,color:#fff
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="section" style="margin-top:48px;">
          <div class="grid-2">
            <a href="log-onboarding.html" class="card" style="padding:20px;text-decoration:none;">
              <div style="color:var(--gray-500);font-size:14px;">← Previous</div>
              <div style="color:var(--primary-700);font-weight:600;">Log Onboarding Guide</div>
            </a>
            <a href="parsing-extraction.html" class="card" style="padding:20px;text-decoration:none;text-align:right;">
              <div style="color:var(--gray-500);font-size:14px;">Next →</div>
              <div style="color:var(--primary-700);font-weight:600;">Parsing & Extraction</div>
            </a>
          </div>
        </div>

      </div>
    </main>
  </div>
  <script src="../js/app.js"></script>
  <script>mermaid.initialize({startOnLoad:true, theme:'neutral'});</script>
</body>
</html>
