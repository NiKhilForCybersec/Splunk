<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Decision Trees | Splunk Reference</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    .diagram-section{background:white;border-radius:16px;padding:32px;margin-bottom:32px;box-shadow:0 1px 3px rgba(0,0,0,0.08);border:1px solid var(--gray-200)}
    .diagram-section h2{font-size:1.5rem;color:#0f172a;margin:0 0 8px}
    .diagram-section>p{color:#64748b;margin:0 0 24px}
    .diagram-box{background:linear-gradient(135deg,#f8fafc 0%,#f1f5f9 100%);border:2px solid #e2e8f0;border-radius:12px;padding:40px;overflow-x:auto}
    .diagram-label{font-size:.8rem;font-weight:700;color:#64748b;text-transform:uppercase;letter-spacing:1.5px;margin-bottom:24px}
    .mermaid{font-size:18px!important}
    .mermaid svg{max-width:none!important}
    .toc-box{background:#f1f5f9;border-radius:12px;padding:24px;margin-bottom:32px}
    .toc-box h3{margin:0 0 16px;color:#1e293b}
    .toc-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    .toc-section h4{font-size:.8rem;color:#475569;margin:0 0 8px;text-transform:uppercase}
    .toc-section a{display:block;color:#3b82f6;text-decoration:none;font-size:.85rem;padding:3px 0}
    .ref-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-top:24px}
    .ref-card{background:white;border-radius:12px;padding:20px 24px;border:1px solid var(--gray-200)}
    .ref-card.critical{border-top:4px solid #dc2626}
    .ref-card.high{border-top:4px solid #f59e0b}
    .ref-card.medium{border-top:4px solid #eab308}
    .ref-card.low{border-top:4px solid #10b981}
    .ref-card h4{margin:0 0 12px;font-size:1rem}
    .ref-card.critical h4{color:#dc2626}
    .ref-card.high h4{color:#f59e0b}
    .ref-card.medium h4{color:#ca8a04}
    .ref-card.low h4{color:#059669}
    .ref-card ul{margin:0;padding-left:20px;font-size:.875rem;color:#475569}
    .ref-card li{margin-bottom:6px}
    .action-box{background:#fef3c7;border-left:4px solid #f59e0b;padding:16px 20px;border-radius:0 8px 8px 0;margin-top:16px}
    .action-box h4{color:#92400e;margin:0 0 8px;font-size:.9rem}
    .action-box ul{margin:0;padding-left:20px;font-size:.85rem}
  </style>
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <a href="../index.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit;">
            <div class="sidebar-logo-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
            <div class="sidebar-logo-text"><h1>Splunk Reference</h1><span>Log & Detection Engineering</span></div>
          </a>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Getting Started</div>
          <a href="../index.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span>Command Center</span></a>
          <a href="day1.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/></svg><span>Day 1 Checklist</span></a>
          <a href="professional-excellence.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg><span>Professional Excellence</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Client Delivery</div>
          <a href="client-delivery.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg><span>Delivery Playbook</span></a>
          <a href="detection-template.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>Use Case Template</span></a>
          <a href="rba-design.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg><span>RBA Design Guide</span></a>
          <a href="cim-mapping.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg><span>CIM Mapping Guide</span></a>
          <a href="es-mechanics.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg><span>ES Mechanics</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Splunk Platform</div>
          <a href="splunk-fundamentals.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>Splunk 101</span></a>
          <a href="splunk-architecture.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg><span>Architecture</span></a>
          <a href="splunk-apps.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg><span>Apps & Add-ons</span></a>
          <a href="splunk-es.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>Enterprise Security</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Log Engineering</div>
          <a href="log-onboarding.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span>Log Onboarding</span></a>
          <a href="data-inputs.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg><span>Data Inputs</span></a>
          <a href="data-flow.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span>Data Flow</span></a>
          <a href="parsing-cim.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg><span>Parsing & CIM</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">SPL Mastery</div>
          <a href="splunk-howto.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg><span>SPL How-To</span></a>
          <a href="spl-reference.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg><span>SPL Reference</span></a>
          <a href="lookups.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg><span>Lookups</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Detection Development</div>
          <a href="correlation-searches.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><span>Correlation Searches</span></a>
          <a href="detection-lifecycle.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg><span>Detection Lifecycle</span></a>
          <a href="decision-trees.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="3"/><line x1="12" y1="8" x2="12" y2="14"/><circle cx="6" cy="19" r="3"/><circle cx="18" cy="19" r="3"/></svg><span>Decision Trees</span></a>
          <a href="troubleshooting.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>Troubleshooting</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Data Sources</div>
          <a href="vendor-akamai.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>Akamai WAF</span></a>
          <a href="vendor-entra.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg><span>Entra ID</span></a>
          <a href="vendor-cyberark.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><span>CyberArk</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Active Projects</div>
          <a href="waf-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span>WAF/DDoS Project</span></a>
          <a href="waf-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>WAF Use Cases</span></a>
          <a href="mfa-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><span>MFA Project</span></a>
          <a href="mfa-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>MFA Use Cases</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="splunk-ops.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/></svg><span>Splunk Cloud Admin</span></a>
          <a href="client-comm.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg><span>Client Comms</span></a>
          <a href="runbooks.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>Runbooks</span></a>
          <a href="cheat-sheets.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="3" x2="9" y2="21"/></svg><span>Cheat Sheets</span></a>
        </div>
      </nav>
      <div class="sidebar-footer"><p>Detection Engineering v3.0</p></div>
    </aside>

    <main class="main-content">
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" aria-label="Toggle menu"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
          <div class="breadcrumb">
            <a href="../index.html" class="breadcrumb-item">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item current">Decision Trees</span>
          </div>
        </div>
        <span class="badge critical">Complete SOC Reference</span>
      </header>

      <div class="page-content">
        <div class="section">
          <h1 class="section-title">Detection Engineering Decision Trees</h1>
          <p class="section-subtitle">Complete visual guides for every security scenario - from triage to investigation to tuning</p>
        </div>

        <!-- TOC -->
        <div class="toc-box">
          <h3>üìë Quick Navigation</h3>
          <div class="toc-grid">
            <div class="toc-section">
              <h4>üö® Alert Triage</h4>
              <a href="#alert-triage">Initial Triage</a>
              <a href="#escalation">Escalation</a>
            </div>
            <div class="toc-section">
              <h4>üîê Identity Alerts</h4>
              <a href="#credential">Credential Attacks</a>
              <a href="#privilege">Privilege Escalation</a>
            </div>
            <div class="toc-section">
              <h4>üíª Infrastructure</h4>
              <a href="#endpoint">Endpoint Alerts</a>
              <a href="#waf">WAF/DDoS</a>
            </div>
            <div class="toc-section">
              <h4>üîß Lifecycle</h4>
              <a href="#tuning">Detection Tuning</a>
              <a href="#investigation">Investigation</a>
            </div>
          </div>
        </div>

        <!-- ALERT TRIAGE -->
        <div class="diagram-section" id="alert-triage">
          <h2>üö® Initial Alert Triage Decision Tree</h2>
          <p>Start here when any alert comes in. Determines priority and next steps.</p>
          <div class="diagram-box">
            <div class="diagram-label">Complete Alert Triage Workflow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    A["üö® Alert Received"] --> B{"Known FP?"}
    B -->|"Yes"| FP["Close as FP"]
    B -->|"No"| C{"In allowlist?"}
    C -->|"Valid"| FP
    C -->|"No"| D{"Privileged user?"}
    D -->|"Yes"| HIGH["üî¥ HIGH"]
    D -->|"No"| E{"Multiple assets?"}
    E -->|"Yes ‚â•3"| HIGH
    E -->|"No"| F{"Critical system?"}
    F -->|"Yes"| HIGH
    F -->|"No"| G{"Attack type?"}
    G -->|"Active exploit"| HIGH
    G -->|"Suspicious"| MED["üü† MEDIUM"]
    G -->|"Policy/Recon"| LOW["üü° LOW"]
    
    HIGH --> R1["Investigate NOW<br/>15 min SLA"]
    MED --> R2["Queue review<br/>4 hour SLA"]
    LOW --> R3["Document<br/>24 hour SLA"]

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style HIGH fill:#dc2626,color:#fff
    style MED fill:#f59e0b,color:#fff
    style LOW fill:#eab308,color:#fff
    style FP fill:#6b7280,color:#fff
            </pre>
          </div>
        </div>

        <!-- ESCALATION -->
        <div class="diagram-section" id="escalation">
          <h2>üìû Incident Escalation Decision Tree</h2>
          <p>After investigation, determine if and how to escalate.</p>
          <div class="diagram-box">
            <div class="diagram-label">Escalation Workflow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    A["üîç Investigation Complete"] --> B{"Compromise confirmed?"}
    B -->|"Yes"| C{"Data exfiltrated?"}
    B -->|"Blocked"| D{"Attack ongoing?"}
    B -->|"Uncertain"| E["Gather more evidence"]
    
    C -->|"Yes"| CRIT["üî¥ CRITICAL SEV-0"]
    C -->|"No"| F{"Privileged acct?"}
    F -->|"Yes"| SEV1["üü† SEV-1"]
    F -->|"No"| SEV2["üü° SEV-2"]
    
    D -->|"Yes"| SEV1
    D -->|"No"| G{"Persistence?"}
    G -->|"Malware"| SEV1
    G -->|"Config change"| SEV2
    G -->|"None"| SEV3["üü¢ SEV-3"]
    
    CRIT --> N1["IMMEDIATE: CISO, Legal, IR, Exec"]
    SEV1 --> N2["30 MIN: Security Lead, IR Team"]
    SEV2 --> N3["4 HRS: Analyst Lead, System Owner"]
    SEV3 --> N4["NEXT DAY: Document + Close"]
    E --> A

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style CRIT fill:#7f1d1d,color:#fff,stroke:#991b1b,stroke-width:3px
    style SEV1 fill:#dc2626,color:#fff
    style SEV2 fill:#f59e0b,color:#fff
    style SEV3 fill:#10b981,color:#fff
            </pre>
          </div>
        </div>

        <!-- CREDENTIAL ATTACK -->
        <div class="diagram-section" id="credential">
          <h2>üîë Credential Attack Investigation Tree</h2>
          <p>Password spray, credential stuffing, brute force, and lockouts.</p>
          <div class="diagram-box">
            <div class="diagram-label">Credential Attack Flow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    A["üîë Credential Attack"] --> B{"Attack type?"}
    
    B -->|"Password Spray"| S1{"Any success?"}
    S1 -->|"Yes"| S2["üî¥ CRITICAL: Disable acct, reset pwd, check lateral"]
    S1 -->|"No"| S3{">50 users?"}
    S3 -->|"Yes"| S4["üü† HIGH: Enable lockout, block IP"]
    S3 -->|"No"| S5["üü° MEDIUM: Monitor"]
    
    B -->|"Credential Stuffing"| T1{"Valid creds found?"}
    T1 -->|"Yes"| T2["üî¥ CRITICAL: Force reset, enable MFA"]
    T1 -->|"No"| T3["üü† HIGH: Update threat intel"]
    
    B -->|"Brute Force"| U1{"Target type?"}
    U1 -->|"Admin/Service"| U2["üî¥ CRITICAL: Block source, verify acct"]
    U1 -->|"Regular"| U3{"Locked out?"}
    U3 -->|"No"| U4["üü† HIGH: No lockout protection"]
    U3 -->|"Yes"| U5["üü° MEDIUM: Lockout working"]
    
    B -->|"Account Lockout"| L1{"Legitimate user?"}
    L1 -->|"Yes"| L2["üü¢ LOW: Unlock, educate"]
    L1 -->|"No"| L3["üü† HIGH: Investigate source"]

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style S2 fill:#7f1d1d,color:#fff
    style T2 fill:#7f1d1d,color:#fff
    style U2 fill:#7f1d1d,color:#fff
    style S4 fill:#dc2626,color:#fff
    style T3 fill:#dc2626,color:#fff
    style U4 fill:#dc2626,color:#fff
    style L3 fill:#dc2626,color:#fff
    style S5 fill:#f59e0b,color:#fff
    style U5 fill:#f59e0b,color:#fff
    style L2 fill:#10b981,color:#fff
            </pre>
          </div>
        </div>

        <!-- PRIVILEGE ESCALATION -->
        <div class="diagram-section" id="privilege">
          <h2>‚¨ÜÔ∏è Privilege Escalation Investigation Tree</h2>
          <p>Role changes, permission grants, and privilege escalation.</p>
          <div class="diagram-box">
            <div class="diagram-label">Privilege Escalation Flow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    A["‚¨ÜÔ∏è Privilege Change"] --> B{"Change type?"}
    
    B -->|"Admin role added"| R1{"Change ticket?"}
    R1 -->|"No"| R2["üî¥ CRITICAL: Remove role, disable actor, escalate"]
    R1 -->|"Yes"| R3{"Approved?"}
    R3 -->|"No"| R4["üü† HIGH: Verify justification"]
    R3 -->|"Yes"| R5["üü¢ LOW: Document"]
    
    B -->|"Permission to PCI/PII"| P1{"Business justification?"}
    P1 -->|"No"| P2["üî¥ CRITICAL: Revoke, investigate"]
    P1 -->|"Yes"| P3{"Least privilege?"}
    P3 -->|"No"| P4["üü† HIGH: Over-privileged"]
    P3 -->|"Yes"| P5["üü¢ LOW: Approved"]
    
    B -->|"Self-elevation"| E1{"How?"}
    E1 -->|"Exploited vuln"| E2["üî¥ CRITICAL: Isolate, patch, forensics"]
    E1 -->|"Misconfiguration"| E3["üü† HIGH: Fix config"]
    E1 -->|"Social eng"| E4["üü† HIGH: User compromised?"]
    
    B -->|"Service account"| S1{"Documented?"}
    S1 -->|"No"| S2["üî¥ CRITICAL: Possible persistence"]
    S1 -->|"Yes"| S3["üü¢ LOW: Approved"]

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style R2 fill:#7f1d1d,color:#fff
    style P2 fill:#7f1d1d,color:#fff
    style E2 fill:#7f1d1d,color:#fff
    style S2 fill:#7f1d1d,color:#fff
    style R4 fill:#dc2626,color:#fff
    style P4 fill:#dc2626,color:#fff
    style E3 fill:#dc2626,color:#fff
    style E4 fill:#dc2626,color:#fff
    style R5 fill:#10b981,color:#fff
    style P5 fill:#10b981,color:#fff
    style S3 fill:#10b981,color:#fff
            </pre>
          </div>
        </div>

        <!-- ENDPOINT ALERTS -->
        <div class="diagram-section" id="endpoint">
          <h2>üíª Endpoint Alert Investigation Tree</h2>
          <p>Malware, suspicious processes, lateral movement, exfiltration.</p>
          <div class="diagram-box">
            <div class="diagram-label">Endpoint Alert Flow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    A["üíª Endpoint Alert"] --> B{"Alert type?"}
    
    B -->|"Malware"| M1{"Quarantined?"}
    M1 -->|"No"| M2["üî¥ CRITICAL: Isolate, memory dump, forensics"]
    M1 -->|"Yes"| M3{"Executed first?"}
    M3 -->|"Yes"| M4["üî¥ CRITICAL: Check persistence, network"]
    M3 -->|"No"| M5["üü° MEDIUM: Verify quarantine, check source"]
    
    B -->|"Suspicious Process"| P1{"Known malicious?"}
    P1 -->|"Yes"| P2["üî¥ CRITICAL: Kill, isolate, forensics"]
    P1 -->|"Behavioral"| P3{"C2-like network?"}
    P3 -->|"Yes"| P4["üî¥ CRITICAL: Possible C2"]
    P3 -->|"No"| P5{"Persistence?"}
    P5 -->|"Yes"| P6["üü† HIGH: Persistence attempt"]
    P5 -->|"No"| P7["üü° MEDIUM: Investigate"]
    
    B -->|"Lateral Movement"| L1{"Technique?"}
    L1 -->|"PsExec/WMI unauthorized"| L2["üî¥ CRITICAL: Block, disable accts, map path"]
    L1 -->|"Pass-the-hash"| L3["üî¥ CRITICAL: Credential theft"]
    L1 -->|"RDP anomaly"| L4["üü† HIGH: Verify user"]
    
    B -->|"Data Exfiltration"| E1{"Data type?"}
    E1 -->|"Sensitive/PCI"| E2["üî¥ CRITICAL: Block, preserve evidence, notify legal"]
    E1 -->|"High volume"| E3["üî¥ CRITICAL: Large transfer"]
    E1 -->|"Unknown"| E4["üü† HIGH: Investigate content"]

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style M2 fill:#7f1d1d,color:#fff
    style M4 fill:#7f1d1d,color:#fff
    style P2 fill:#7f1d1d,color:#fff
    style P4 fill:#7f1d1d,color:#fff
    style L2 fill:#7f1d1d,color:#fff
    style L3 fill:#7f1d1d,color:#fff
    style E2 fill:#7f1d1d,color:#fff
    style E3 fill:#7f1d1d,color:#fff
    style P6 fill:#dc2626,color:#fff
    style L4 fill:#dc2626,color:#fff
    style E4 fill:#dc2626,color:#fff
    style M5 fill:#f59e0b,color:#fff
    style P7 fill:#f59e0b,color:#fff
            </pre>
          </div>
        </div>

        <!-- WAF/DDOS -->
        <div class="diagram-section" id="waf">
          <h2>üõ°Ô∏è WAF/DDoS Alert Investigation Tree</h2>
          <p>Web application firewall and DDoS attack investigation.</p>
          <div class="diagram-box">
            <div class="diagram-label">WAF/DDoS Alert Flow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    A["üõ°Ô∏è WAF Alert"] --> B{"Volume in 5min?"}
    
    B -->|"‚â•1000 blocks"| C{"Unique IPs?"}
    C -->|"‚â•50"| D["üî¥ DDoS: Activate mitigation, rate limit, contact CDN"]
    C -->|"<50"| E["üü† TARGETED: Block IPs, geo-block, review rules"]
    C -->|"Single"| F["üü† AGGRESSIVE SCANNER: Block source"]
    
    B -->|"100-999"| G{"Attack type?"}
    G -->|"SQLi"| H["üü† SQL INJECTION: Check app/DB logs, block source"]
    G -->|"RCE"| I["üî¥ RCE ATTEMPT: High priority, verify blocks"]
    G -->|"XSS"| J["üü° XSS: Verify blocks, update rules"]
    G -->|"Path traversal"| K["üü° PATH TRAVERSAL: Check file access"]
    
    B -->|"<100"| L{"Single IP?"}
    L -->|"Yes"| M{"Known scanner?"}
    M -->|"Yes"| N["üü¢ KNOWN SCANNER: Document"]
    M -->|"No"| O["üü° INVESTIGATE: New threat?"]
    L -->|"Multiple"| P["üü° RECON: Monitor pattern"]

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style D fill:#7f1d1d,color:#fff
    style I fill:#7f1d1d,color:#fff
    style E fill:#dc2626,color:#fff
    style F fill:#dc2626,color:#fff
    style H fill:#dc2626,color:#fff
    style J fill:#f59e0b,color:#fff
    style K fill:#f59e0b,color:#fff
    style O fill:#f59e0b,color:#fff
    style P fill:#f59e0b,color:#fff
    style N fill:#10b981,color:#fff
            </pre>
          </div>
        </div>

        <!-- DETECTION TUNING -->
        <div class="diagram-section" id="tuning">
          <h2>üîß Detection Tuning Workflow</h2>
          <p>Systematic approach to improving detection accuracy.</p>
          <div class="diagram-box">
            <div class="diagram-label">Detection Tuning Flow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    A["üîß Tuning Needed"] --> B{"Problem?"}
    
    B -->|"Too many FPs"| F1["Analyze FP pattern"]
    F1 --> F2{"Cause?"}
    F2 -->|"Known good"| F3["‚úÖ Add allowlist"]
    F2 -->|"Time pattern"| F4["‚úÖ Add time filter"]
    F2 -->|"Threshold low"| F5["‚úÖ Raise threshold"]
    F2 -->|"Missing context"| F6["‚úÖ Add enrichment"]
    F2 -->|"Logic broad"| F7["‚úÖ Refine conditions"]
    
    B -->|"Missing detections"| N1["Analyze missed"]
    N1 --> N2{"Why missed?"}
    N2 -->|"Threshold high"| N3["‚úÖ Lower threshold"]
    N2 -->|"No data"| N4["‚úÖ Fix data source"]
    N2 -->|"Logic narrow"| N5["‚úÖ Broaden detection"]
    N2 -->|"Evasion"| N6["‚úÖ Add new detection"]
    
    B -->|"Too slow"| P1["Analyze search"]
    P1 --> P2{"Bottleneck?"}
    P2 -->|"Too much data"| P3["‚úÖ Narrow index/sourcetype"]
    P2 -->|"Expensive SPL"| P4["‚úÖ Use tstats"]
    P2 -->|"Large lookup"| P5["‚úÖ Use KV store"]
    
    F3 --> V["Validate: FP<20%, <60s, catches attacks"]
    F4 --> V
    F5 --> V
    F6 --> V
    F7 --> V
    N3 --> V
    N4 --> V
    N5 --> V
    N6 --> V
    P3 --> V
    P4 --> V
    P5 --> V
    V --> DONE["‚úÖ Complete"]

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style DONE fill:#059669,color:#fff,stroke:#047857,stroke-width:3px
    style F3 fill:#10b981,color:#fff
    style F4 fill:#10b981,color:#fff
    style F5 fill:#10b981,color:#fff
    style F6 fill:#10b981,color:#fff
    style F7 fill:#10b981,color:#fff
    style N3 fill:#10b981,color:#fff
    style N4 fill:#10b981,color:#fff
    style N5 fill:#10b981,color:#fff
    style N6 fill:#10b981,color:#fff
    style P3 fill:#10b981,color:#fff
    style P4 fill:#10b981,color:#fff
    style P5 fill:#10b981,color:#fff
            </pre>
          </div>
        </div>

        <!-- INVESTIGATION -->
        <div class="diagram-section" id="investigation">
          <h2>üîç Investigation Process</h2>
          <p>5-step systematic investigation workflow.</p>
          <div class="diagram-box">
            <div class="diagram-label">Investigation Workflow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '18px', 'fontFamily': 'Inter'}}}%%
flowchart TB
    subgraph S1["1Ô∏è‚É£ GATHER"]
        A["Start"] --> B["Collect alert details"]
        B --> C["ID entities: User, IP, Host"]
        C --> D["Establish timeline"]
        D --> E["Check related alerts"]
    end
    
    subgraph S2["2Ô∏è‚É£ ENRICH"]
        E --> F["Asset lookup"]
        F --> G["User lookup"]
        G --> H["Threat intel check"]
        H --> I["Historical baseline"]
    end
    
    subgraph S3["3Ô∏è‚É£ SCOPE"]
        I --> J{"Single or multiple?"}
        J -->|"Multiple"| K["Campaign investigation"]
        J -->|"Single"| L["Focused investigation"]
        K --> M{"Lateral movement?"}
        L --> M
        M -->|"Yes"| N["Expand to all systems"]
        M -->|"No"| O["Contain scope"]
    end
    
    subgraph S4["4Ô∏è‚É£ ANALYZE"]
        N --> P["Deep analysis"]
        O --> P
        P --> Q{"Compromise?"}
        Q -->|"Yes"| R["Document IOCs"]
        Q -->|"No"| S["Document findings"]
        Q -->|"Unclear"| T["Collect more: memory, disk, pcap"]
        T --> P
    end
    
    subgraph S5["5Ô∏è‚É£ CONCLUDE"]
        R --> U{"Severity?"}
        U -->|"Critical"| V["Escalate immediately"]
        U -->|"High"| W["Remediate + ticket"]
        U -->|"Med/Low"| X["Monitor + watchlist"]
        S --> Y["Close: FP/Benign/Suspicious"]
        Y --> Z["Update detection if needed"]
    end

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style V fill:#7f1d1d,color:#fff
    style W fill:#dc2626,color:#fff
    style X fill:#f59e0b,color:#fff
    style Z fill:#10b981,color:#fff
            </pre>
          </div>
          
          <div class="action-box">
            <h4>üìã Investigation Checklist</h4>
            <ul>
              <li>‚òê Alert details documented (what, when, where)</li>
              <li>‚òê Key entities identified (user, IP, host, process)</li>
              <li>‚òê Timeline established (first ‚Üí last seen)</li>
              <li>‚òê Related alerts checked (same entities/timeframe)</li>
              <li>‚òê Asset/user enrichment completed</li>
              <li>‚òê Threat intel checked (known bad indicators)</li>
              <li>‚òê Scope determined (lateral movement?)</li>
              <li>‚òê Evidence preserved (screenshots, exports)</li>
              <li>‚òê Findings documented (IOCs, impact)</li>
              <li>‚òê Closure decision + detection update</li>
            </ul>
          </div>
        </div>

        <!-- QUICK REFERENCE -->
        <div class="diagram-section">
          <h2>üìã Quick Reference - Severity Guide</h2>
          <div class="ref-grid">
            <div class="ref-card critical">
              <h4>üî¥ CRITICAL - Immediate</h4>
              <ul>
                <li>Confirmed data breach/exfiltration</li>
                <li>Active ransomware or malware</li>
                <li>Privileged account compromise</li>
                <li>MFA bypass with successful login</li>
                <li>Credential stuffing with valid logins</li>
                <li>Unauthorized admin role assignment</li>
                <li>RCE attempts detected</li>
                <li>Active DDoS attack</li>
              </ul>
            </div>
            <div class="ref-card high">
              <h4>üü† HIGH - 30 Minutes</h4>
              <ul>
                <li>MFA push bombing (‚â•5 denials)</li>
                <li>Password spray with any success</li>
                <li>Impossible travel - privileged user</li>
                <li>High volume WAF blocks</li>
                <li>Lateral movement indicators</li>
                <li>Suspicious process with persistence</li>
                <li>Service account modification</li>
                <li>SQL injection attempts</li>
              </ul>
            </div>
            <div class="ref-card medium">
              <h4>üü° MEDIUM - 4 Hours</h4>
              <ul>
                <li>New MFA device (verify with user)</li>
                <li>Login from new country</li>
                <li>Brute force with lockouts working</li>
                <li>Malware blocked before execution</li>
                <li>Permission change without ticket</li>
                <li>After-hours sensitive access</li>
                <li>XSS/path traversal attempts</li>
                <li>Policy violation</li>
              </ul>
            </div>
            <div class="ref-card low">
              <h4>üü¢ LOW - 24 Hours</h4>
              <ul>
                <li>Single failed login</li>
                <li>Known scanner activity</li>
                <li>Service account routine</li>
                <li>User-confirmed legitimate action</li>
                <li>Account lockout from typo</li>
                <li>Approved role/permission change</li>
                <li>Expected maintenance</li>
                <li>Low-risk reconnaissance</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="section" style="margin-top:48px;">
          <div class="grid grid-2">
            <a href="troubleshooting.html" class="card" style="padding:20px;text-decoration:none;">
              <div style="color:var(--gray-500);font-size:14px;">‚Üê Previous</div>
              <div style="color:var(--primary-700);font-weight:600;">Troubleshooting Guide</div>
            </a>
            <a href="runbooks.html" class="card" style="padding:20px;text-decoration:none;text-align:right;">
              <div style="color:var(--gray-500);font-size:14px;">Next ‚Üí</div>
              <div style="color:var(--primary-700);font-weight:600;">SOC Runbooks</div>
            </a>
          </div>
        </div>
      
        <!-- SITE FOOTER -->
        <footer style="margin-top:48px;padding:24px;background:var(--gray-100);border-radius:8px;text-align:center;font-size:0.85rem;color:var(--gray-600);">
          <div style="margin-bottom:8px;">
            <strong>Splunk Detection Engineering Reference</strong> | Version 2.0 | Last Updated: February 2, 2026
          </div>
          <div>
            Internal Use Only | Detection Engineering Team
          </div>
        </footer>

      </div>
    </main>
  </div>
  <script src="../js/app.js"></script>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        fontSize: '18px',
        fontFamily: 'Inter, sans-serif',
        primaryColor: '#3b82f6',
        primaryTextColor: '#ffffff',
        lineColor: '#475569'
      },
      flowchart: {
        htmlLabels: true,
        curve: 'basis',
        nodeSpacing: 40,
        rankSpacing: 50,
        padding: 15,
        useMaxWidth: false
      }
    });
  </script>
</body>
</html>
