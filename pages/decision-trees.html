<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Decision Trees & Workflows | myfirstpro Detection Engineering</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <style>
    .tree-tabs{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:24px;border-bottom:2px solid var(--gray-200);padding-bottom:16px;}
    .tree-tab{padding:10px 16px;border-radius:6px 6px 0 0;cursor:pointer;font-size:0.8125rem;font-weight:500;background:var(--gray-100);color:var(--gray-600);border:1px solid var(--gray-200);border-bottom:none;transition:all 0.2s;}
    .tree-tab:hover{background:var(--gray-200);}
    .tree-tab.active{background:var(--primary-500);color:white;border-color:var(--primary-500);}
    .tree-tab .icon{margin-right:6px;}
    .tree-content{display:none;}
    .tree-content.active{display:block;}
    .tree-container{background:white;border-radius:12px;padding:32px;min-height:500px;border:1px solid var(--gray-200);overflow-x:auto;}
    .tree-header{margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid var(--gray-100);}
    .tree-header h3{font-size:1.25rem;color:var(--gray-900);margin-bottom:8px;}
    .tree-header p{font-size:0.875rem;color:var(--gray-600);line-height:1.6;}
    .tree-diagram{min-height:400px;display:flex;justify-content:center;align-items:flex-start;padding:20px 0;}
    .tree-legend{margin-top:24px;padding:16px;background:var(--gray-50);border-radius:8px;}
    .tree-legend h4{font-size:0.875rem;color:var(--gray-700);margin-bottom:12px;}
    .legend-items{display:flex;flex-wrap:wrap;gap:16px;}
    .legend-item{display:flex;align-items:center;gap:8px;font-size:0.8125rem;}
    .legend-color{width:16px;height:16px;border-radius:4px;}
    .quick-ref{margin-top:24px;padding:16px;background:var(--primary-50);border-radius:8px;border-left:4px solid var(--primary-500);}
    .quick-ref h4{font-size:0.875rem;color:var(--primary-700);margin-bottom:8px;}
    .quick-ref ul{font-size:0.8125rem;color:var(--gray-600);margin:0;padding-left:20px;line-height:1.8;}
  </style>
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <a href="../index.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit;">
            <div class="sidebar-logo-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            </div>
            <div class="sidebar-logo-text">
              <h1>myfirstpro</h1>
              <span>Detection Engineering</span>
            </div>
          </a>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Getting Started</div>
          <a href="../index.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span>Command Center</span></a>
          <a href="day1.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/></svg><span>Day 1 Checklist</span></a>
          <a href="client-comm.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg><span>Client Communication</span></a>
          <a href="professional-excellence.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg><span>Professional Excellence</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Splunk Fundamentals</div>
          <a href="splunk-fundamentals.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>Splunk 101</span></a>
          <a href="splunk-es.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>Enterprise Security</span></a>
          <a href="data-flow.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span>Data Flow & Event Hub</span></a>
          <a href="detection-lifecycle.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg><span>Detection Lifecycle</span></a>
          <a href="splunk-howto.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg><span>Splunk How-To Guide</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Data Sources</div>
          <a href="vendor-akamai.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>Akamai WAF</span></a>
          <a href="vendor-cyberark.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><span>CyberArk Identity</span></a>
          <a href="vendor-entra.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg><span>Entra ID</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Splunk Operations</div>
          <a href="waf-onboarding.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span>Log Onboarding</span></a>
          <a href="parsing-cim.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg><span>Parsing & CIM</span></a>
          <a href="lookups.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg><span>Lookups Deep Dive</span></a>
          <a href="splunk-ops.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg><span>Splunk Cloud Ops</span></a>
          <a href="spl-reference.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg><span>SPL Reference</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">WAF/DDoS Project</div>
          <a href="waf-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span>Project Overview</span></a>
          <a href="waf-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>Use Cases (UC1-12)</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">MFA Project</div>
          <a href="mfa-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span>Project Overview</span></a>
          <a href="mfa-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>Use Cases (UC1-8)</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Response & Support</div>
          <a href="decision-trees.html" class="nav-item active"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="3"/><line x1="12" y1="8" x2="12" y2="14"/><circle cx="6" cy="19" r="3"/><circle cx="18" cy="19" r="3"/></svg><span>Decision Trees</span></a>
          <a href="troubleshooting.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><span>Troubleshooting</span></a>
          <a href="runbooks.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>SOC Runbooks</span></a>
        </div>
      </nav>
      <div class="sidebar-footer"><p>Detection Engineering v2.0</p></div>
    </aside>

    <main class="main-content">
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" aria-label="Toggle menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
          </button>
          <div class="breadcrumb">
            <a href="../index.html" class="breadcrumb-item">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item current">Decision Trees & Workflows</span>
          </div>
        </div>
        <span class="badge primary">11 Visual Guides</span>
      </header>

      <div class="page-content">
        <div class="section">
          <h1 class="section-title">Decision Trees & Workflows</h1>
          <p class="section-subtitle">Visual guides for detection engineering decisions, triage processes, and operational workflows. Click each tab for full-size diagrams.</p>
        </div>

        <!-- Tab Navigation -->
        <div class="section">
          <div class="tree-tabs">
            <div class="tree-tab active" onclick="showTree('dev')"><span class="icon">üîß</span>Detection Dev</div>
            <div class="tree-tab" onclick="showTree('triage')"><span class="icon">üö®</span>Alert Triage</div>
            <div class="tree-tab" onclick="showTree('validation')"><span class="icon">‚úÖ</span>Data Validation</div>
            <div class="tree-tab" onclick="showTree('incident')"><span class="icon">üî•</span>Incident Response</div>
            <div class="tree-tab" onclick="showTree('notable')"><span class="icon">üìã</span>Notable Lifecycle</div>
            <div class="tree-tab" onclick="showTree('tuning')"><span class="icon">üéõÔ∏è</span>Tuning Process</div>
            <div class="tree-tab" onclick="showTree('escalation')"><span class="icon">üìû</span>Escalation</div>
            <div class="tree-tab" onclick="showTree('pattern')"><span class="icon">üéØ</span>Pattern Selection</div>
            <div class="tree-tab" onclick="showTree('timeline')"><span class="icon">üìÖ</span>Project Timeline</div>
            <div class="tree-tab" onclick="showTree('architecture')"><span class="icon">üèóÔ∏è</span>Architecture</div>
            <div class="tree-tab" onclick="showTree('waf')"><span class="icon">üõ°Ô∏è</span>WAF Response</div>
          </div>

          <!-- ==================== DETECTION DEVELOPMENT ==================== -->
          <div id="dev" class="tree-content active">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üîß Detection Development Lifecycle</h3>
                <p>Complete workflow from use case request to production deployment. Follow this process for every new detection to ensure quality and consistency.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    subgraph P1["üìù Phase 1: Requirements"]
        A1[Receive use case request] --> A2{Clear requirements?}
        A2 -->|No| A3[Clarify with stakeholder]
        A3 --> A2
        A2 -->|Yes| A4[Document use case spec]
        A4 --> A5[Identify data sources]
    end
    
    subgraph P2["üîç Phase 2: Data Validation"]
        A5 --> B1{Data available?}
        B1 -->|No| B2[Request onboarding]
        B2 --> B1
        B1 -->|Yes| B4[Validate fields]
        B4 --> B5{Fields exist?}
        B5 -->|No| B6[Fix parsing]
        B6 --> B4
        B5 -->|Yes| B7[Document mappings]
    end
    
    subgraph P3["‚öôÔ∏è Phase 3: Development"]
        B7 --> C1[Build SPL query]
        C1 --> C2[Test with known events]
        C2 --> C3{Expected results?}
        C3 -->|No| C4[Refine logic]
        C4 --> C2
        C3 -->|Yes| C5[Add thresholds]
    end
    
    subgraph P4["üß™ Phase 4: Testing"]
        C5 --> D1[Run 7-day historical]
        D1 --> D2{FP rate OK?}
        D2 -->|High| D3[Tune thresholds]
        D3 --> D1
        D2 -->|OK| D6[Document tuning]
    end
    
    subgraph P5["üöÄ Phase 5: Deploy"]
        D6 --> E1[Create correlation search]
        E1 --> E2[Configure notable]
        E2 --> E3[Set throttling]
        E3 --> E4[Enable production]
        E4 --> E5[Monitor 48 hours]
        E5 --> E6{Working?}
        E6 -->|No| E7[Hotfix]
        E7 --> E5
        E6 -->|Yes| E8[‚úÖ Complete]
    end
    
    style A1 fill:#e0f2fe,stroke:#0284c7
    style E8 fill:#dcfce7,stroke:#16a34a
                </div>
              </div>
              <div class="quick-ref">
                <h4>Quick Reference</h4>
                <ul>
                  <li><strong>Phase 1:</strong> Never start without documented requirements</li>
                  <li><strong>Phase 2:</strong> Data validation prevents wasted development time</li>
                  <li><strong>Phase 3:</strong> Always test with known-good events first</li>
                  <li><strong>Phase 4:</strong> Target &lt;10 FPs/day before deployment</li>
                  <li><strong>Phase 5:</strong> 48-hour monitoring period is mandatory</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- ==================== ALERT TRIAGE ==================== -->
          <div id="triage" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üö® Alert Triage Workflow</h3>
                <p>Step-by-step process for SOC analysts to triage incoming alerts from creation to closure.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    A[üîî New Alert] --> B[Open Incident Review]
    B --> C[Review details]
    
    C --> D{Duplicate?}
    D -->|Yes| E[Link to existing]
    E --> F[Close duplicate]
    
    D -->|No| G{Sufficient context?}
    G -->|No| H[Run drilldowns]
    H --> G
    
    G -->|Yes| I{True positive?}
    
    I -->|Clear FP| J[Document reason]
    J --> K{Recurring FP?}
    K -->|Yes| L[Create tuning ticket]
    K -->|No| M[Close as FP]
    
    I -->|Needs investigation| N[Escalate Tier 2]
    
    I -->|True Positive| O{Severity?}
    
    O -->|Low/Med| P[Create ticket]
    P --> Q[Follow runbook]
    Q --> R[Close]
    
    O -->|High/Critical| S[üö® Immediate escalation]
    S --> T[Page on-call]
    T --> U[Incident response]
    
    style A fill:#fef3c7,stroke:#d97706
    style S fill:#fee2e2,stroke:#dc2626
    style F fill:#dcfce7,stroke:#16a34a
    style M fill:#dcfce7,stroke:#16a34a
    style R fill:#dcfce7,stroke:#16a34a
                </div>
              </div>
              <div class="tree-legend">
                <h4>Disposition Codes</h4>
                <div class="legend-items">
                  <div class="legend-item"><div class="legend-color" style="background:#dc2626;"></div>True Positive - Confirmed</div>
                  <div class="legend-item"><div class="legend-color" style="background:#f97316;"></div>True Positive - Benign</div>
                  <div class="legend-item"><div class="legend-color" style="background:#eab308;"></div>False Positive - Tuning Needed</div>
                  <div class="legend-item"><div class="legend-color" style="background:#22c55e;"></div>False Positive - Expected</div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== DATA VALIDATION ==================== -->
          <div id="validation" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>‚úÖ Data Validation Workflow</h3>
                <p>Verify data quality before building detections. Prevents building rules on broken data.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    A[üîç Start Validation] --> B[Run health check]
    
    B --> C{Events in 60m?}
    C -->|No| D[‚ùå Data not flowing]
    D --> E[Check HEC]
    E --> F[Check source]
    F --> G{Resolved?}
    G -->|No| H[Escalate to admin]
    G -->|Yes| B
    
    C -->|Yes| I{Volume normal?}
    I -->|Low| J[‚ö†Ô∏è Possible data loss]
    J --> K[Compare to source]
    
    I -->|OK| L[Check fields]
    
    L --> M{Fields present?}
    M -->|No| N[‚ùå Parsing issue]
    N --> O[Fix props.conf]
    
    M -->|Yes| P{Values valid?}
    P -->|No| Q[‚ö†Ô∏è Mapping issue]
    Q --> R[Create ticket]
    
    P -->|Yes| S[Check timestamps]
    S --> T{Time accurate?}
    T -->|No| U[‚ö†Ô∏è Timezone issue]
    
    T -->|Yes| V[‚úÖ Validated]
    V --> W[Document results]
    W --> X[Proceed with detection]
    
    style D fill:#fee2e2,stroke:#dc2626
    style N fill:#fee2e2,stroke:#dc2626
    style J fill:#fef3c7,stroke:#d97706
    style Q fill:#fef3c7,stroke:#d97706
    style U fill:#fef3c7,stroke:#d97706
    style V fill:#dcfce7,stroke:#16a34a
                </div>
              </div>
              <div class="quick-ref">
                <h4>Validation Checklist</h4>
                <ul>
                  <li>‚úÖ Events flowing within last 60 minutes</li>
                  <li>‚úÖ Event count matches expected (¬±20%)</li>
                  <li>‚úÖ Required fields extracted</li>
                  <li>‚úÖ Field values match expected format</li>
                  <li>‚úÖ Timestamps accurate (within 5 min)</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- ==================== INCIDENT RESPONSE ==================== -->
          <div id="incident" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üî• Incident Response Decision Tree</h3>
                <p>High-level IR workflow for security incidents detected by your rules.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    A[üö® Incident Detected] --> B{Type?}
    
    B -->|Account Compromise| C[Disable account]
    C --> C1[Reset credentials]
    C1 --> C2[Review activity]
    C2 --> C3[Check persistence]
    
    B -->|Malware| D[Isolate system]
    D --> D1[Preserve evidence]
    D1 --> D2[ID malware family]
    D2 --> D3[Determine scope]
    
    B -->|Data Exfil| E[ID data accessed]
    E --> E1{PII/PHI?}
    E1 -->|Yes| E2[Legal notification]
    E1 -->|No| E3[Internal investigation]
    
    B -->|Active Attack| F[üö® Block attacker IP]
    F --> F1[Preserve artifacts]
    F1 --> F2[Page IR Lead]
    F2 --> F3[Activate war room]
    
    C3 --> G[Document]
    D3 --> G
    E2 --> G
    E3 --> G
    F3 --> G
    
    G --> H[Post-mortem]
    H --> I[Update detections]
    I --> J[Close incident]
    
    style A fill:#fee2e2,stroke:#dc2626
    style F fill:#fee2e2,stroke:#dc2626
    style J fill:#dcfce7,stroke:#16a34a
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== NOTABLE LIFECYCLE ==================== -->
          <div id="notable" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üìã Notable Event Lifecycle</h3>
                <p>Complete lifecycle of a Notable event in Splunk Enterprise Security.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart LR
    subgraph S1["1Ô∏è‚É£ Creation"]
        A1[Search Runs] --> A2[Threshold Met]
        A2 --> A3[Notable Created]
        A3 --> A4["Status: NEW"]
    end
    
    subgraph S2["2Ô∏è‚É£ Assignment"]
        A4 --> B1[Incident Review]
        B1 --> B2[Analyst Claims]
        B2 --> B3["Status: IN PROGRESS"]
    end
    
    subgraph S3["3Ô∏è‚É£ Investigation"]
        B3 --> C1[Drilldowns]
        C1 --> C2[Gather Context]
        C2 --> C3[Make Decision]
    end
    
    subgraph S4["4Ô∏è‚É£ Resolution"]
        C3 --> D1{Disposition}
        D1 -->|TP| D2[Remediate]
        D1 -->|FP| D3[Tune]
        D1 -->|Benign| D4[Document]
        D2 --> D5["Status: RESOLVED"]
        D3 --> D5
        D4 --> D5
    end
    
    subgraph S5["5Ô∏è‚É£ Closure"]
        D5 --> E1[Add Comments]
        E1 --> E2["Status: CLOSED"]
    end
    
    style A4 fill:#fef3c7,stroke:#d97706
    style B3 fill:#e0f2fe,stroke:#0284c7
    style D5 fill:#dbeafe,stroke:#3b82f6
    style E2 fill:#dcfce7,stroke:#16a34a
                </div>
              </div>
              <div class="tree-legend">
                <h4>Status Flow</h4>
                <div class="legend-items">
                  <div class="legend-item"><div class="legend-color" style="background:#d97706;"></div>New</div>
                  <div class="legend-item"><div class="legend-color" style="background:#0284c7;"></div>In Progress</div>
                  <div class="legend-item"><div class="legend-color" style="background:#8b5cf6;"></div>Pending</div>
                  <div class="legend-item"><div class="legend-color" style="background:#3b82f6;"></div>Resolved</div>
                  <div class="legend-item"><div class="legend-color" style="background:#16a34a;"></div>Closed</div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== TUNING PROCESS ==================== -->
          <div id="tuning" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üéõÔ∏è Detection Tuning Process</h3>
                <p>Systematic approach to tuning based on false positive patterns.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    A[üìä FP Pattern Found] --> B{Single or recurring?}
    
    B -->|Single| C[Document exception]
    C --> D[Close as FP]
    
    B -->|Recurring| E[Analyze pattern]
    E --> F{Root cause?}
    
    F -->|Legit Activity| G[Add to allowlist]
    G --> H[Create lookup entry]
    
    F -->|Threshold Issue| I[Adjust threshold]
    I --> J{Direction?}
    J -->|Fewer alerts| K[Increase value]
    J -->|More coverage| L[Decrease value]
    
    F -->|Missing Context| M[Add filter]
    M --> N[Add WHERE clause]
    
    F -->|Time Pattern| O[Add time filter]
    O --> P[Business hours only?]
    
    H --> Q[Validate tuning]
    K --> Q
    L --> Q
    N --> Q
    P --> Q
    
    Q --> R{FP rate OK?}
    R -->|No| S[Refine more]
    S --> E
    R -->|Yes| T[Deploy]
    T --> U[Monitor 7 days]
    U --> V{Success?}
    V -->|No| W[Rollback]
    W --> E
    V -->|Yes| X[‚úÖ Document]
    
    style A fill:#fef3c7,stroke:#d97706
    style X fill:#dcfce7,stroke:#16a34a
    style W fill:#fee2e2,stroke:#dc2626
                </div>
              </div>
              <div class="quick-ref">
                <h4>Tuning Best Practices</h4>
                <ul>
                  <li><strong>Document:</strong> Every change needs a ticket</li>
                  <li><strong>Test:</strong> Run against 7 days historical</li>
                  <li><strong>Monitor:</strong> Watch 7 days post-tuning</li>
                  <li><strong>Preserve:</strong> Don't tune away real attacks</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- ==================== ESCALATION ==================== -->
          <div id="escalation" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üìû Escalation Decision Tree</h3>
                <p>When and how to escalate based on severity.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    A[‚ö†Ô∏è Incident] --> B{Severity?}
    
    B -->|Info| C[Log & Monitor]
    C --> D[No escalation]
    
    B -->|Low| E[Standard ticket]
    E --> F[Tier 1 handles]
    F --> G{Resolved 4h?}
    G -->|Yes| H[Close]
    G -->|No| I[‚Üí Tier 2]
    
    B -->|Medium| J[Priority ticket]
    J --> K[Tier 2 assigned]
    K --> L{Resolved 2h?}
    L -->|Yes| M[Close]
    L -->|No| N[‚Üí Tier 3]
    
    B -->|High| O[üî¥ Immediate]
    O --> P[Page Tier 3]
    P --> Q[15-min SLA]
    Q --> R{Active threat?}
    R -->|Yes| S[‚Üí IR Lead]
    R -->|No| T[Tier 3 investigates]
    
    B -->|Critical| U[üö® CRITICAL]
    U --> V[Page IR Lead NOW]
    V --> W[Page CISO 30m]
    W --> X[War room]
    
    S --> Y[Containment]
    T --> Y
    X --> Y
    
    style U fill:#fee2e2,stroke:#dc2626
    style O fill:#fef3c7,stroke:#d97706
    style D fill:#dcfce7,stroke:#16a34a
    style H fill:#dcfce7,stroke:#16a34a
    style M fill:#dcfce7,stroke:#16a34a
                </div>
              </div>
              <div class="tree-legend">
                <h4>Escalation Contacts</h4>
                <div class="legend-items">
                  <div class="legend-item"><div class="legend-color" style="background:#22c55e;"></div>Tier 1: SOC (24/7)</div>
                  <div class="legend-item"><div class="legend-color" style="background:#3b82f6;"></div>Tier 2: Senior (On-Call)</div>
                  <div class="legend-item"><div class="legend-color" style="background:#8b5cf6;"></div>Tier 3: Engineers</div>
                  <div class="legend-item"><div class="legend-color" style="background:#dc2626;"></div>IR Lead</div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== PATTERN SELECTION ==================== -->
          <div id="pattern" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üéØ Detection Pattern Selection</h3>
                <p>Choose the right detection pattern for your use case.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    A[üéØ New Use Case] --> B{Detecting what?}
    
    B -->|Volume anomaly| C[Threshold-Based]
    B -->|Specific behavior| D[Sequence-Based]
    B -->|Deviation from normal| E[Baseline-Based]
    B -->|Known patterns| F[Signature-Based]
    
    C --> G{Static or dynamic?}
    G -->|Fixed| H["count > X"]
    G -->|Relative| I["count > avg + 2œÉ"]
    
    D --> J{Complexity?}
    J -->|A then B| K[streamstats]
    J -->|Chain| L[transaction]
    J -->|Time window| M[bin + stats]
    
    E --> N{Baseline type?}
    N -->|User| O[Per-user lookup]
    N -->|System| P[Global avg]
    N -->|Time| Q[Hour/day pattern]
    
    F --> R{Source?}
    R -->|Vendor| S[Native fields]
    R -->|Intel| T[Lookup enrichment]
    R -->|Custom| U[Regex match]
    
    style C fill:#cce5ff,stroke:#007bff
    style D fill:#d4edda,stroke:#28a745
    style E fill:#fff3cd,stroke:#ffc107
    style F fill:#e2e3e5,stroke:#6c757d
                </div>
              </div>
              <div class="quick-ref">
                <h4>Pattern Selection Guide</h4>
                <ul>
                  <li><strong>Threshold:</strong> DDoS, brute force, scanning</li>
                  <li><strong>Sequence:</strong> Multi-stage attacks, kill chain</li>
                  <li><strong>Baseline:</strong> Insider threats, unusual behavior</li>
                  <li><strong>Signature:</strong> Known malware, exploits</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- ==================== PROJECT TIMELINE ==================== -->
          <div id="timeline" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üìÖ 6-Month Project Delivery Timeline</h3>
                <p>Gantt chart showing the planned rollout of all detection use cases.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
gantt
    title Detection Engineering - 6 Month Timeline
    dateFormat YYYY-MM-DD
    
    section Foundation
    Kickoff & Discovery :a1, 2024-01-01, 7d
    Data Validation :a2, after a1, 7d
    
    section WAF Phase 1
    UC1-UC4 Block/Source/Auth/SQLi :b1, after a2, 28d
    
    section WAF Phase 2
    UC5-UC8 Distributed/Geo/Bypass/Bot :c1, after b1, 28d
    
    section WAF Phase 3
    UC9-UC12 API/Path/Scanner/Rate :c2, after c1, 28d
    
    section MFA
    UC1-UC4 Fatigue/Success/Travel/Location :d1, after c2, 28d
    UC5-UC8 Hours/Brute/Device/Dormant :d2, after d1, 28d
    
    section Closeout
    Documentation :e1, after d2, 14d
    Knowledge Transfer :e2, after e1, 7d
    Hypercare :e3, after e2, 14d
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== ARCHITECTURE ==================== -->
          <div id="architecture" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üèóÔ∏è Data Flow Architecture</h3>
                <p>End-to-end data flow from sources through Splunk to response.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart LR
    subgraph Sources["üì° Sources"]
        S1[üõ°Ô∏è Akamai]
        S2[üîê CyberArk]
        S3[‚òÅÔ∏è Entra]
    end
    
    subgraph Integration["üîå Integration"]
        I1[SIEM API]
        I2[Connector]
        I3[Graph API]
    end
    
    subgraph Splunk["‚òÅÔ∏è Splunk Cloud"]
        HEC[HEC] --> IDX[(Indexes)]
        IDX --> SH[Search Head]
        SH --> DET[Correlation]
        DET --> NOT[Notables]
    end
    
    subgraph Response["üì£ Response"]
        R1[üìß Email]
        R2[üí¨ Slack]
        R3[ü§ñ SOAR]
        R4[üé´ SNOW]
    end
    
    S1 --> I1 --> HEC
    S2 --> I2 --> HEC
    S3 --> I3 --> HEC
    
    NOT --> R1 & R2 & R3 & R4
    
    style HEC fill:#65a637,stroke:#4a7c28
    style DET fill:#cce5ff,stroke:#007bff
    style NOT fill:#fee2e2,stroke:#dc2626
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== WAF RESPONSE ==================== -->
          <div id="waf" class="tree-content">
            <div class="tree-container">
              <div class="tree-header">
                <h3>üõ°Ô∏è WAF Alert Response Workflow</h3>
                <p>Specific workflow for responding to WAF security alerts.</p>
              </div>
              <div class="tree-diagram">
                <div class="mermaid">
flowchart TD
    A[üõ°Ô∏è WAF Alert] --> B{Type?}
    
    B -->|Volume| C[Check trend]
    B -->|Single IP| D[Analyze IP]
    B -->|Injection| E[Review payloads]
    B -->|Auth| F[Check cred stuffing]
    
    C --> G{Spike > 5œÉ?}
    G -->|Yes| H[üî¥ Active attack]
    G -->|No| I[Monitor]
    
    D --> J[IP reputation]
    J --> K{Known bad?}
    K -->|Yes| L[Verify blocking]
    K -->|No| M{Corporate NAT?}
    M -->|Yes| N[FP - NAT]
    M -->|No| O[New threat]
    
    E --> P{Blocked?}
    P -->|Yes| Q[Check bypass]
    P -->|No| R[üö® Check backend]
    R --> S{500 errors?}
    S -->|Yes| T[Possible compromise]
    S -->|No| U[WAF effective]
    
    F --> V{Multi-user?}
    V -->|Yes| W[Campaign]
    V -->|No| X[Single brute force]
    W --> Y[Alert identity team]
    
    H --> Z[Escalate Tier 2]
    T --> Z
    
    L --> AA[Close]
    Q --> AA
    U --> AA
    N --> AA
    
    style A fill:#e0f2fe,stroke:#0284c7
    style H fill:#fee2e2,stroke:#dc2626
    style T fill:#fee2e2,stroke:#dc2626
    style AA fill:#dcfce7,stroke:#16a34a
                </div>
              </div>
              <div class="quick-ref">
                <h4>WAF Quick Actions</h4>
                <ul>
                  <li><strong>Volume spike:</strong> Check if legitimate (sale, launch)</li>
                  <li><strong>Single IP:</strong> Verify blocking, geo-block if persistent</li>
                  <li><strong>Injection:</strong> Always check backend for 500 errors</li>
                  <li><strong>Auth attacks:</strong> Coordinate with identity team</li>
                </ul>
              </div>
            </div>
          </div>

        </div>
      </div>
    </main>
  </div>
  
  <script src="../js/app.js"></script>
  <script>
    mermaid.initialize({
      startOnLoad: true, 
      theme: 'neutral', 
      flowchart: { 
        curve: 'basis',
        nodeSpacing: 50,
        rankSpacing: 50,
        padding: 15
      },
      gantt: {
        fontSize: 11,
        barHeight: 20,
        barGap: 4
      }
    });

    function showTree(id) {
      document.querySelectorAll('.tree-content').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.tree-tab').forEach(el => el.classList.remove('active'));
      
      document.getElementById(id).classList.add('active');
      document.querySelector(`[onclick="showTree('${id}')"]`).classList.add('active');
      
      setTimeout(() => {
        mermaid.init(undefined, document.querySelectorAll('.mermaid'));
      }, 100);
    }
  </script>
</body>
</html>
