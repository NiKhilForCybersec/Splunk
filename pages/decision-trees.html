<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Decision Trees | Splunk Reference</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    .diagram-container {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border: 2px solid #e2e8f0;
      border-radius: 16px;
      padding: 40px;
      margin: 24px 0;
      overflow-x: auto;
      min-height: 400px;
    }
    .diagram-container .mermaid {
      min-width: 900px;
    }
    .diagram-label {
      font-size: 0.75rem;
      font-weight: 600;
      color: #64748b;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .diagram-scroll-hint {
      font-size: 0.75rem;
      color: #94a3b8;
      text-align: right;
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <a href="../index.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit;">
            <div class="sidebar-logo-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            </div>
            <div class="sidebar-logo-text">
              <h1>Splunk Reference</h1>
              <span>Detection Engineering</span>
            </div>
          </a>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Getting Started</div>
          <a href="../index.html" class="nav-item">Command Center</a>
          <a href="day1.html" class="nav-item">Day 1 Checklist</a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Active Projects</div>
          <a href="waf-overview.html" class="nav-item">WAF/DDoS Project</a>
          <a href="mfa-overview.html" class="nav-item">MFA Project</a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="splunk-ops.html" class="nav-item">Splunk Cloud Admin</a>
          <a href="troubleshooting.html" class="nav-item">Troubleshooting</a>
          <a href="decision-trees.html" class="nav-item active">Decision Trees</a>
          <a href="runbooks.html" class="nav-item">SOC Runbooks</a>
        </div>
      </nav>
    </aside>
    
    <main class="main-content">
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" aria-label="Toggle menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/>
            </svg>
          </button>
          <div class="breadcrumb">
            <a href="../index.html" class="breadcrumb-item">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item current">Decision Trees</span>
          </div>
        </div>
        <span class="badge critical">SOC Reference</span>
      </header>

      <div class="page-content">
        <div class="section">
          <h1 class="section-title">Security Decision Trees</h1>
          <p class="section-subtitle">Comprehensive visual guides for SOC analysts to make consistent decisions during investigations</p>
        </div>

        <!-- ============================================ -->
        <!-- ALERT TRIAGE - FULL COMPLEXITY -->
        <!-- ============================================ -->
        <div class="section">
          <h2 class="subsection-title">üö® Alert Triage Decision Tree</h2>
          <p>Complete workflow for triaging incoming security alerts. Covers initial assessment, severity determination, and routing.</p>
          
          <div class="diagram-container">
            <div class="diagram-label">Complete Alert Triage Workflow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '14px', 'fontFamily': 'Inter, sans-serif'}}}%%
flowchart TB
    subgraph INITIAL["üì• INITIAL ASSESSMENT"]
        A["üö® New Alert Received"]
        A --> B{"Is this a<br/>known false positive?"}
        B -->|"Yes - documented"| B1["Close as FP<br/>Document pattern"]
        B -->|"No or unsure"| C{"Check allowlist<br/>Is source whitelisted?"}
        C -->|"Yes"| C1["Verify allowlist<br/>still valid"]
        C1 -->|"Valid"| B1
        C1 -->|"Expired/Invalid"| D
        C -->|"No"| D{"Is data quality<br/>sufficient?"}
        D -->|"Missing fields"| D1["Flag data gap<br/>Investigate anyway"]
        D -->|"Good quality"| E
    end

    subgraph SEVERITY["‚ö†Ô∏è SEVERITY ASSESSMENT"]
        E{"Is a privileged<br/>user involved?"}
        E -->|"Yes - Admin/DBA/Security"| HIGH["üî¥ HIGH PRIORITY"]
        E -->|"No - Standard user"| F{"Are multiple<br/>assets affected?"}
        F -->|"Yes - 3+ systems"| HIGH
        F -->|"No - Single asset"| G{"Is this a<br/>critical system?"}
        G -->|"Yes - Prod/Financial/PII"| HIGH
        G -->|"No"| H{"Attack technique<br/>severity?"}
        H -->|"RCE/SQLi/Ransomware"| HIGH
        H -->|"Recon/Scanning"| MEDIUM["üü† MEDIUM PRIORITY"]
        H -->|"Policy violation"| LOW["üü° LOW PRIORITY"]
    end

    subgraph ACTION["‚úÖ NEXT STEPS"]
        HIGH --> I["Immediate investigation<br/>15 min SLA"]
        I --> I1["Gather context<br/>Check related alerts"]
        I1 --> I2["Contact asset owner<br/>if needed"]
        
        MEDIUM --> J["Queue for review<br/>4 hour SLA"]
        J --> J1["Batch with similar<br/>alerts if possible"]
        
        LOW --> K["Document and monitor<br/>24 hour SLA"]
        K --> K1["Add to weekly<br/>review queue"]
    end

    D1 --> E

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style HIGH fill:#dc2626,color:#fff,stroke:#b91c1c,stroke-width:2px
    style MEDIUM fill:#f59e0b,color:#fff,stroke:#d97706
    style LOW fill:#eab308,color:#fff,stroke:#ca8a04
    style B1 fill:#6b7280,color:#fff
    style I fill:#10b981,color:#fff
    style J fill:#10b981,color:#fff
    style K fill:#10b981,color:#fff
            </pre>
            <div class="diagram-scroll-hint">‚Üê Scroll horizontally if needed ‚Üí</div>
          </div>
        </div>

        <!-- ============================================ -->
        <!-- INCIDENT ESCALATION - FULL COMPLEXITY -->
        <!-- ============================================ -->
        <div class="section">
          <h2 class="subsection-title">üìû Incident Escalation Decision Tree</h2>
          <p>Determines when, how, and to whom security incidents should be escalated based on impact and evidence.</p>
          
          <div class="diagram-container">
            <div class="diagram-label">Complete Escalation Workflow</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '14px', 'fontFamily': 'Inter, sans-serif'}}}%%
flowchart TB
    subgraph ASSESS["üîç IMPACT ASSESSMENT"]
        A["üîç Investigation<br/>Complete"]
        A --> B{"Is compromise<br/>confirmed?"}
        B -->|"Yes - Evidence found"| C{"Was data<br/>exfiltrated?"}
        B -->|"No - Attack blocked"| D{"Is attack<br/>still ongoing?"}
        B -->|"Uncertain"| E["Gather more<br/>evidence first"]
        
        C -->|"Yes - Data left network"| CRIT["üî¥ CRITICAL<br/>Data Breach"]
        C -->|"No - Contained"| F{"Privileged account<br/>compromised?"}
        C -->|"Unknown - Check logs"| F
        
        D -->|"Yes - Active threat"| SEV1["üü† SEV-1<br/>Active Incident"]
        D -->|"No - Stopped"| G{"Any damage<br/>or persistence?"}
    end

    subgraph CLASSIFY["üìä CLASSIFICATION"]
        F -->|"Yes - Admin/Service acct"| SEV1
        F -->|"No - Standard user"| SEV2["üü° SEV-2<br/>Contained Incident"]
        
        G -->|"Malware installed"| SEV1
        G -->|"Config changed"| SEV2
        G -->|"No impact"| SEV3["üü¢ SEV-3<br/>Attempted Attack"]
    end

    subgraph ESCALATE["üìû ESCALATION PATH"]
        CRIT --> H["IMMEDIATE:<br/>1. CISO/Security Director<br/>2. Legal/Compliance<br/>3. IR Team Lead<br/>4. Executive Team"]
        H --> H1["Invoke IR Plan<br/>Preserve evidence<br/>Consider disclosure"]
        
        SEV1 --> I["WITHIN 30 MIN:<br/>1. Security Lead<br/>2. IR Team<br/>3. System Owner"]
        I --> I1["Active containment<br/>Block threat actor<br/>Preserve evidence"]
        
        SEV2 --> J["WITHIN 4 HOURS:<br/>1. Security Analyst Lead<br/>2. System Owner"]
        J --> J1["Document fully<br/>Reset credentials<br/>Monitor for recurrence"]
        
        SEV3 --> K["NEXT BUSINESS DAY:<br/>1. Document in ticket<br/>2. Update threat intel"]
        K --> K1["Improve detection<br/>Update blocklists<br/>Close ticket"]
    end

    E --> A

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style CRIT fill:#7f1d1d,color:#fff,stroke:#991b1b,stroke-width:3px
    style SEV1 fill:#dc2626,color:#fff,stroke:#b91c1c,stroke-width:2px
    style SEV2 fill:#f59e0b,color:#fff,stroke:#d97706
    style SEV3 fill:#10b981,color:#fff,stroke:#059669
    style H fill:#7f1d1d,color:#fff
    style I fill:#dc2626,color:#fff
    style J fill:#f59e0b,color:#fff
    style K fill:#10b981,color:#fff
            </pre>
            <div class="diagram-scroll-hint">‚Üê Scroll horizontally if needed ‚Üí</div>
          </div>
        </div>

        <!-- ============================================ -->
        <!-- MFA ALERT - FULL COMPLEXITY -->
        <!-- ============================================ -->
        <div class="section">
          <h2 class="subsection-title">üîê MFA Alert Investigation Tree</h2>
          <p>Complete workflow for investigating MFA-related security alerts including push bombing, bypass, and device registration.</p>
          
          <div class="diagram-container">
            <div class="diagram-label">Complete MFA Alert Investigation</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '14px', 'fontFamily': 'Inter, sans-serif'}}}%%
flowchart TB
    subgraph TRIAGE["üì• INITIAL TRIAGE"]
        A["üîê MFA Alert<br/>Received"]
        A --> B{"Alert type?"}
        
        B -->|"Push Bombing<br/>(Multiple denials)"| C{"Denials followed<br/>by SUCCESS?"}
        B -->|"New Device<br/>Registration"| D{"User initiated<br/>or unexpected?"}
        B -->|"Method Change<br/>Downgrade"| E{"Changed from<br/>strong to weak?"}
        B -->|"MFA Disabled"| F{"For privileged<br/>account?"}
    end

    subgraph PUSHBOMB["üö® PUSH BOMBING PATH"]
        C -->|"Yes - Success after denials"| CRIT1["üî¥ CRITICAL<br/>Likely Compromised"]
        C -->|"No - All denied"| G{"Count >= 10<br/>in 10 minutes?"}
        G -->|"Yes"| HIGH1["üü† HIGH<br/>Active Attack"]
        G -->|"No - < 10"| H{"Privileged<br/>user?"}
        H -->|"Yes"| HIGH1
        H -->|"No"| MED1["üü° MEDIUM<br/>Suspicious Activity"]
    end

    subgraph DEVICE["üì± NEW DEVICE PATH"]
        D -->|"Unexpected"| I{"During off-hours<br/>or from new location?"}
        D -->|"User confirmed"| LOW1["üü¢ LOW<br/>Document & Close"]
        I -->|"Yes - Suspicious timing"| HIGH2["üü† HIGH<br/>Possible Persistence"]
        I -->|"No - Normal pattern"| MED2["üü° MEDIUM<br/>Verify with User"]
    end

    subgraph METHOD["üîÑ METHOD CHANGE PATH"]
        E -->|"Yes - FIDO2/App ‚Üí SMS"| HIGH3["üü† HIGH<br/>Possible SIM Swap Prep"]
        E -->|"No - Same strength"| LOW2["üü¢ LOW<br/>Monitor"]
    end

    subgraph DISABLED["‚ö†Ô∏è MFA DISABLED PATH"]
        F -->|"Yes - Admin account"| CRIT2["üî¥ CRITICAL<br/>Security Control Removed"]
        F -->|"No - Standard user"| J{"Change ticket<br/>exists?"}
        J -->|"Yes - Approved"| LOW3["üü¢ LOW<br/>Document & Close"]
        J -->|"No - Unauthorized"| HIGH4["üü† HIGH<br/>Unauthorized Change"]
    end

    subgraph RESPONSE["‚úÖ RESPONSE ACTIONS"]
        CRIT1 --> R1["IMMEDIATE:<br/>1. Disable account<br/>2. Revoke sessions<br/>3. Call user directly<br/>4. Reset all credentials<br/>5. Check for persistence"]
        CRIT2 --> R1
        
        HIGH1 --> R2["URGENT:<br/>1. Contact user via phone<br/>2. Verify activity<br/>3. If unconfirmed ‚Üí Disable<br/>4. Review access logs"]
        HIGH2 --> R2
        HIGH3 --> R2
        HIGH4 --> R2
        
        MED1 --> R3["STANDARD:<br/>1. Email user for verification<br/>2. Review recent activity<br/>3. Document findings"]
        MED2 --> R3
    end

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style CRIT1 fill:#7f1d1d,color:#fff,stroke:#991b1b,stroke-width:3px
    style CRIT2 fill:#7f1d1d,color:#fff,stroke:#991b1b,stroke-width:3px
    style HIGH1 fill:#dc2626,color:#fff
    style HIGH2 fill:#dc2626,color:#fff
    style HIGH3 fill:#dc2626,color:#fff
    style HIGH4 fill:#dc2626,color:#fff
    style MED1 fill:#f59e0b,color:#fff
    style MED2 fill:#f59e0b,color:#fff
    style LOW1 fill:#10b981,color:#fff
    style LOW2 fill:#10b981,color:#fff
    style LOW3 fill:#10b981,color:#fff
    style R1 fill:#7f1d1d,color:#fff
    style R2 fill:#dc2626,color:#fff
    style R3 fill:#f59e0b,color:#fff
            </pre>
            <div class="diagram-scroll-hint">‚Üê Scroll horizontally if needed ‚Üí</div>
          </div>
        </div>

        <!-- ============================================ -->
        <!-- WAF ALERT - FULL COMPLEXITY -->
        <!-- ============================================ -->
        <div class="section">
          <h2 class="subsection-title">üõ°Ô∏è WAF/DDoS Alert Investigation Tree</h2>
          <p>Complete workflow for investigating Web Application Firewall alerts including DDoS, injection attacks, and scanning.</p>
          
          <div class="diagram-container">
            <div class="diagram-label">Complete WAF Alert Investigation</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '14px', 'fontFamily': 'Inter, sans-serif'}}}%%
flowchart TB
    subgraph TRIAGE["üì• INITIAL ASSESSMENT"]
        A["üõ°Ô∏è WAF Alert<br/>Received"]
        A --> B{"Block volume<br/>in 5 minutes?"}
        
        B -->|">= 1000 blocks"| C{"Number of<br/>unique source IPs?"}
        B -->|"100-999 blocks"| D{"Attack type<br/>detected?"}
        B -->|"< 100 blocks"| E{"Single IP<br/>or multiple?"}
    end

    subgraph DDOS["üåä HIGH VOLUME PATH"]
        C -->|">= 50 IPs (Distributed)"| DDOS1["üî¥ DDoS ATTACK<br/>Distributed Attack"]
        C -->|"< 50 IPs (Concentrated)"| DDOS2["üü† TARGETED ATTACK<br/>Coordinated Assault"]
        C -->|"Single IP"| DDOS3["üü† SINGLE SOURCE<br/>Aggressive Scanner/Bot"]
    end

    subgraph ATTACK["‚öîÔ∏è ATTACK TYPE PATH"]
        D -->|"SQLi detected"| ATK1["üü† SQL INJECTION<br/>Check if any succeeded"]
        D -->|"XSS detected"| ATK2["üü° XSS ATTEMPT<br/>Verify blocking"]
        D -->|"RCE/Command Injection"| ATK3["üî¥ RCE ATTEMPT<br/>Critical - Check app logs"]
        D -->|"Path traversal"| ATK4["üü° PATH TRAVERSAL<br/>Check sensitive paths"]
        D -->|"Generic/Unknown"| ATK5["üü° RECON/SCANNING<br/>Analyze patterns"]
    end

    subgraph LOW["üìä LOW VOLUME PATH"]
        E -->|"Single IP"| F{"Known scanner<br/>or researcher?"}
        E -->|"Multiple IPs"| G{"Coordinated<br/>timing?"}
        
        F -->|"Yes - Documented"| LOW1["üü¢ KNOWN SCANNER<br/>Document & Monitor"]
        F -->|"No - Unknown"| LOW2["üü° INVESTIGATE<br/>Check threat intel"]
        
        G -->|"Yes - Same timeframe"| ATK5
        G -->|"No - Random"| LOW1
    end

    subgraph RESPONSE["‚úÖ RESPONSE ACTIONS"]
        DDOS1 --> R1["IMMEDIATE:<br/>1. Activate DDoS mitigation<br/>2. Enable rate limiting<br/>3. Contact Akamai support<br/>4. Monitor application health<br/>5. Notify stakeholders"]
        
        DDOS2 --> R2["URGENT:<br/>1. Block top offending IPs<br/>2. Enable geo-blocking if applicable<br/>3. Review WAF rules<br/>4. Check for successful requests"]
        DDOS3 --> R2
        
        ATK1 --> R3["HIGH PRIORITY:<br/>1. Check application logs<br/>2. Verify no successful injection<br/>3. Review database logs<br/>4. Block source IP at edge"]
        ATK3 --> R3
        
        ATK2 --> R4["STANDARD:<br/>1. Verify blocks working<br/>2. Update threat intel<br/>3. Review similar patterns"]
        ATK4 --> R4
        ATK5 --> R4
        LOW2 --> R4
    end

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style DDOS1 fill:#7f1d1d,color:#fff,stroke:#991b1b,stroke-width:3px
    style DDOS2 fill:#dc2626,color:#fff
    style DDOS3 fill:#dc2626,color:#fff
    style ATK1 fill:#dc2626,color:#fff
    style ATK3 fill:#7f1d1d,color:#fff,stroke:#991b1b,stroke-width:2px
    style ATK2 fill:#f59e0b,color:#fff
    style ATK4 fill:#f59e0b,color:#fff
    style ATK5 fill:#f59e0b,color:#fff
    style LOW1 fill:#10b981,color:#fff
    style LOW2 fill:#f59e0b,color:#fff
    style R1 fill:#7f1d1d,color:#fff
    style R2 fill:#dc2626,color:#fff
    style R3 fill:#dc2626,color:#fff
    style R4 fill:#f59e0b,color:#fff
            </pre>
            <div class="diagram-scroll-hint">‚Üê Scroll horizontally if needed ‚Üí</div>
          </div>
        </div>

        <!-- ============================================ -->
        <!-- DETECTION DEPLOYMENT - FULL COMPLEXITY -->
        <!-- ============================================ -->
        <div class="section">
          <h2 class="subsection-title">üöÄ Detection Deployment Readiness Tree</h2>
          <p>Complete checklist workflow for determining if a detection is ready for production deployment.</p>
          
          <div class="diagram-container">
            <div class="diagram-label">Complete Deployment Readiness Check</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '14px', 'fontFamily': 'Inter, sans-serif'}}}%%
flowchart TB
    subgraph DEV["üîß DEVELOPMENT CHECKS"]
        A["üöÄ Ready to Deploy<br/>Detection?"]
        A --> B{"SPL syntax<br/>validated?"}
        B -->|"No"| B1["‚ùå STOP<br/>Fix SPL errors first"]
        B -->|"Yes"| C{"Tested with<br/>14+ days data?"}
        C -->|"No"| C1["‚ùå STOP<br/>Need more test data"]
        C -->|"Yes"| D{"Performance<br/>< 60 seconds?"}
        D -->|"No"| D1["‚ùå STOP<br/>Optimize search"]
        D -->|"Yes"| E
    end

    subgraph TEST["üß™ TESTING CHECKS"]
        E{"Silent mode<br/>run >= 7 days?"}
        E -->|"No"| E1["‚ùå STOP<br/>Complete silent mode"]
        E -->|"Yes"| F{"False positive<br/>rate < 20%?"}
        F -->|"No"| F1["‚ùå STOP<br/>Tune thresholds/allowlists"]
        F -->|"Yes"| G{"Alert volume<br/>manageable?"}
        G -->|"No - Too many"| G1["‚ùå STOP<br/>Raise thresholds"]
        G -->|"Yes"| H
    end

    subgraph DOCS["üìö DOCUMENTATION CHECKS"]
        H{"Threshold rationale<br/>documented?"}
        H -->|"No"| H1["‚ùå STOP<br/>Document thresholds"]
        H -->|"Yes"| I{"SOC runbook<br/>created?"}
        I -->|"No"| I1["‚ùå STOP<br/>Write runbook"]
        I -->|"Yes"| J{"Allowlists<br/>documented?"}
        J -->|"No"| J1["‚ùå STOP<br/>Document exclusions"]
        J -->|"Yes"| K
    end

    subgraph OPS["‚öôÔ∏è OPERATIONAL CHECKS"]
        K{"Alert action<br/>configured?"}
        K -->|"No"| K1["‚ùå STOP<br/>Configure email/ticket"]
        K -->|"Yes"| L{"Suppression rules<br/>set?"}
        L -->|"No"| L1["‚ùå STOP<br/>Add throttle settings"]
        L -->|"Yes"| M{"SOC team<br/>trained?"}
        M -->|"No"| M1["‚ùå STOP<br/>Conduct KT session"]
        M -->|"Yes"| N{"Rollback plan<br/>ready?"}
        N -->|"No"| N1["‚ùå STOP<br/>Document rollback"]
        N -->|"Yes"| GO["‚úÖ READY FOR<br/>PRODUCTION!"]
    end

    B1 --> B
    C1 --> C
    D1 --> D
    E1 --> E
    F1 --> F
    G1 --> G
    H1 --> H
    I1 --> I
    J1 --> J
    K1 --> K
    L1 --> L
    M1 --> M
    N1 --> N

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style GO fill:#059669,color:#fff,stroke:#047857,stroke-width:3px
    style B1 fill:#ef4444,color:#fff
    style C1 fill:#ef4444,color:#fff
    style D1 fill:#ef4444,color:#fff
    style E1 fill:#ef4444,color:#fff
    style F1 fill:#ef4444,color:#fff
    style G1 fill:#ef4444,color:#fff
    style H1 fill:#ef4444,color:#fff
    style I1 fill:#ef4444,color:#fff
    style J1 fill:#ef4444,color:#fff
    style K1 fill:#ef4444,color:#fff
    style L1 fill:#ef4444,color:#fff
    style M1 fill:#ef4444,color:#fff
    style N1 fill:#ef4444,color:#fff
            </pre>
            <div class="diagram-scroll-hint">‚Üê Scroll horizontally if needed ‚Üí</div>
          </div>

          <!-- Go-Live Checklist -->
          <div class="card" style="padding:24px;margin-top:20px;border:2px solid #10b981;background:#ecfdf5;">
            <h4 style="color:#059669;margin-top:0;">‚úÖ Complete Go-Live Checklist</h4>
            <div class="grid grid-3" style="gap:20px;margin-top:16px;">
              <div>
                <p style="font-weight:600;color:#065f46;margin-bottom:8px;">Development</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê SPL validated against live data</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê 14+ days test data reviewed</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Search completes < 60 sec</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê All required fields extract</p>
              </div>
              <div>
                <p style="font-weight:600;color:#065f46;margin-bottom:8px;">Testing</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Silent mode 7+ days complete</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê FP rate < 20%</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Alert volume sustainable</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Edge cases tested</p>
              </div>
              <div>
                <p style="font-weight:600;color:#065f46;margin-bottom:8px;">Documentation</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Threshold rationale documented</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê SOC runbook complete</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Allowlists documented</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê MITRE ATT&CK mapped</p>
              </div>
              <div>
                <p style="font-weight:600;color:#065f46;margin-bottom:8px;">Operations</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Alert action configured</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Suppression/throttle set</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Lookups scheduled refresh</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Monitoring dashboard ready</p>
              </div>
              <div>
                <p style="font-weight:600;color:#065f46;margin-bottom:8px;">Handover</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê SOC team trained</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Escalation path defined</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Detection owner assigned</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Client sign-off received</p>
              </div>
              <div>
                <p style="font-weight:600;color:#065f46;margin-bottom:8px;">Rollback</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Rollback procedure documented</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Hypercare period agreed (2 weeks)</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Tuning process documented</p>
                <p style="margin:4px 0;font-size:0.875rem;">‚òê Success criteria defined</p>
              </div>
            </div>
          </div>
        </div>

        <!-- ============================================ -->
        <!-- COMMUNICATION - FULL COMPLEXITY -->
        <!-- ============================================ -->
        <div class="section">
          <h2 class="subsection-title">üí¨ Communication & Escalation Tree</h2>
          <p>Complete workflow for professional communication with different stakeholders.</p>
          
          <div class="diagram-container">
            <div class="diagram-label">Complete Communication Decision Tree</div>
            <pre class="mermaid">
%%{init: {'theme': 'base', 'themeVariables': {'fontSize': '14px', 'fontFamily': 'Inter, sans-serif'}}}%%
flowchart TB
    subgraph TRIGGER["üí¨ COMMUNICATION TRIGGER"]
        A["üí¨ Need to<br/>Communicate"]
        A --> B{"What is the<br/>purpose?"}
        
        B --> C["Status Update"]
        B --> D["Blocker/Risk"]
        B --> E["Question"]
        B --> F["Deliverable"]
    end

    subgraph STATUS["üìä STATUS UPDATES"]
        C --> C1{"Who is the<br/>audience?"}
        C1 -->|"Technical Team"| C2["Slack/Email<br/>Technical details<br/>SPL snippets OK"]
        C1 -->|"Project Manager"| C3["Email with structure<br/>Progress %, blockers<br/>Next steps"]
        C1 -->|"Management"| C4["Executive summary<br/>Focus on progress & risks<br/>Timeline impact"]
        C1 -->|"Client/Business"| C5["Business-focused<br/>Outcomes delivered<br/>Value demonstrated"]
    end

    subgraph BLOCKER["üöß BLOCKERS & RISKS"]
        D --> D1{"Is it blocking<br/>progress?"}
        D1 -->|"Yes - Work stopped"| D2{"Can you solve<br/>it yourself?"}
        D1 -->|"No - Risk only"| D3["Document in status<br/>Propose mitigation<br/>Monitor closely"]
        
        D2 -->|"Yes with time"| D4["Inform stakeholder<br/>Provide timeline<br/>Continue working"]
        D2 -->|"Need help"| D5["Escalate immediately<br/>Clear ask required<br/>Proposed solutions"]
        D2 -->|"External dependency"| D6["Escalate to owner<br/>Identify who can help<br/>Track in RAID log"]
        
        D5 --> D7{"Who to escalate to?"}
        D7 -->|"Technical issue"| D8["Tech Lead or SME"]
        D7 -->|"Resource issue"| D9["Project Manager"]
        D7 -->|"Client issue"| D10["Engagement Manager"]
        D7 -->|"Security incident"| D11["Security Lead<br/>Follow IR process"]
    end

    subgraph QUESTION["‚ùì QUESTIONS"]
        E --> E1{"How urgent?"}
        E1 -->|"Immediate - blocking"| E2["Direct message or call<br/>Be specific about urgency<br/>Explain impact"]
        E1 -->|"Can wait 4-24 hours"| E3["Email with context<br/>Explain what you've tried<br/>Propose options"]
        E1 -->|"General/FYI"| E4["Add to next meeting<br/>or weekly sync"]
    end

    subgraph DELIVER["üì¶ DELIVERABLES"]
        F --> F1{"Formal review<br/>needed?"}
        F1 -->|"Yes - Approval required"| F2["Schedule review meeting<br/>Share materials 24h ahead<br/>Prepare walkthrough"]
        F1 -->|"No - FYI only"| F3["Email with summary<br/>Attach deliverable<br/>Offer to discuss"]
    end

    style A fill:#3b82f6,color:#fff,stroke:#1d4ed8,stroke-width:3px
    style C2 fill:#10b981,color:#fff
    style C3 fill:#10b981,color:#fff
    style C4 fill:#f59e0b,color:#fff
    style C5 fill:#8b5cf6,color:#fff
    style D3 fill:#10b981,color:#fff
    style D4 fill:#10b981,color:#fff
    style D5 fill:#ef4444,color:#fff
    style D6 fill:#f59e0b,color:#fff
    style D11 fill:#ef4444,color:#fff
    style E2 fill:#ef4444,color:#fff
    style E3 fill:#10b981,color:#fff
    style E4 fill:#10b981,color:#fff
    style F2 fill:#f59e0b,color:#fff
    style F3 fill:#10b981,color:#fff
            </pre>
            <div class="diagram-scroll-hint">‚Üê Scroll horizontally if needed ‚Üí</div>
          </div>
        </div>

        <!-- ============================================ -->
        <!-- QUICK REFERENCE -->
        <!-- ============================================ -->
        <div class="section">
          <h2 class="subsection-title">üìã Quick Reference Cards</h2>
          
          <div class="grid grid-2" style="gap:20px;">
            <div class="card" style="padding:20px;border-top:4px solid #dc2626;">
              <h4 style="color:#dc2626;margin-top:0;">üî¥ CRITICAL - Immediate Action Required</h4>
              <ul style="margin:0;padding-left:20px;font-size:0.875rem;">
                <li>Confirmed data breach / exfiltration</li>
                <li>Active ransomware or malware spreading</li>
                <li>Privileged account compromise confirmed</li>
                <li>Production system compromised</li>
                <li>MFA bypass with successful login</li>
                <li>Active threat actor in network</li>
                <li>DDoS attack impacting availability</li>
              </ul>
            </div>
            
            <div class="card" style="padding:20px;border-top:4px solid #f59e0b;">
              <h4 style="color:#f59e0b;margin-top:0;">üü† HIGH - Investigate Within 30 Minutes</h4>
              <ul style="margin:0;padding-left:20px;font-size:0.875rem;">
                <li>MFA push bombing (>= 5 denials)</li>
                <li>Impossible travel detected for privileged user</li>
                <li>High volume WAF blocks from single source</li>
                <li>Brute force attack in progress</li>
                <li>New admin account created unexpectedly</li>
                <li>SQLi or RCE attempts detected</li>
                <li>Unauthorized MFA method change</li>
              </ul>
            </div>
            
            <div class="card" style="padding:20px;border-top:4px solid #eab308;">
              <h4 style="color:#ca8a04;margin-top:0;">üü° MEDIUM - Review Within 4 Hours</h4>
              <ul style="margin:0;padding-left:20px;font-size:0.875rem;">
                <li>New MFA device registered (verify with user)</li>
                <li>Login from new country (non-privileged user)</li>
                <li>Suspicious user agent detected</li>
                <li>After-hours access to sensitive system</li>
                <li>Permission or role changes</li>
                <li>Moderate WAF block volume</li>
                <li>Failed logins from multiple IPs</li>
              </ul>
            </div>
            
            <div class="card" style="padding:20px;border-top:4px solid #10b981;">
              <h4 style="color:#059669;margin-top:0;">üü¢ LOW - Monitor / Document</h4>
              <ul style="margin:0;padding-left:20px;font-size:0.875rem;">
                <li>Single failed login attempt</li>
                <li>Known scanner / security researcher</li>
                <li>Service account routine activity</li>
                <li>Expected maintenance window</li>
                <li>User-confirmed legitimate action</li>
                <li>Low-risk policy violation</li>
                <li>Reconnaissance / port scanning</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="section" style="margin-top:48px;">
          <div class="grid grid-2">
            <a href="troubleshooting.html" class="card" style="padding:20px;text-decoration:none;">
              <div style="color:var(--gray-500);font-size:14px;">‚Üê Previous</div>
              <div style="color:var(--primary-700);font-weight:600;">Troubleshooting</div>
            </a>
            <a href="runbooks.html" class="card" style="padding:20px;text-decoration:none;text-align:right;">
              <div style="color:var(--gray-500);font-size:14px;">Next ‚Üí</div>
              <div style="color:var(--primary-700);font-weight:600;">SOC Runbooks</div>
            </a>
          </div>
        </div>

      </div>
    </main>
  </div>
  <script src="../js/app.js"></script>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        fontSize: '14px',
        fontFamily: 'Inter, sans-serif',
        primaryColor: '#3b82f6',
        primaryTextColor: '#ffffff',
        primaryBorderColor: '#1d4ed8',
        lineColor: '#475569',
        secondaryColor: '#f1f5f9',
        tertiaryColor: '#e2e8f0'
      },
      flowchart: {
        htmlLabels: true,
        curve: 'basis',
        nodeSpacing: 30,
        rankSpacing: 40,
        padding: 12,
        useMaxWidth: false
      }
    });
  </script>
</body>
</html>
