<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Splunk Operations Guide | Sobeys Detection Engineering</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <div class="app-container">
        <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          </div>
          <div class="sidebar-logo-text">
            <h1>Sobeys Detection</h1>
            <span>Engineering Command Center</span>
          </div>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="../index.html" class="nav-item" data-page="index">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>
            <span>Command Center</span>
          </a>
          <a href="day1.html" class="nav-item" data-page="day1">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/></svg>
            <span>Day 1 — Getting Started</span>
          </a>
          <a href="client-meetings.html" class="nav-item" data-page="client-meetings">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>
            <span>Client Meeting Prep</span>
          </a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Vendor Deep Dives</div>
          <a href="vendor-akamai.html" class="nav-item" data-page="vendor-akamai">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            <span>Akamai WAF</span>
          </a>
          <a href="vendor-cyberark.html" class="nav-item" data-page="vendor-cyberark">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/></svg>
            <span>CyberArk Identity</span>
            <span class="badge critical" style="margin-left: auto; font-size: 0.625rem;">PRIMARY</span>
          </a>
          <a href="vendor-entra.html" class="nav-item" data-page="vendor-entra">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            <span>Microsoft Entra ID</span>
          </a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Fundamentals</div>
          <a href="fundamentals-waf.html" class="nav-item" data-page="fundamentals-waf">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            <span>WAF Fundamentals</span>
          </a>
          <a href="fundamentals-ddos.html" class="nav-item" data-page="fundamentals-ddos">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M2 12h20"/></svg>
            <span>DDoS Fundamentals</span>
          </a>
          <a href="fundamentals-mfa.html" class="nav-item" data-page="fundamentals-mfa">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            <span>MFA Fundamentals</span>
          </a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">WAF/DDoS Project</div>
          <a href="waf-overview.html" class="nav-item" data-page="waf-overview">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            <span>Project Overview</span>
          </a>
          <a href="waf-uc1.html" class="nav-item" data-page="waf-uc1">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            <span>UC1: Block Volume</span>
          </a>
          <a href="waf-uc2-4.html" class="nav-item" data-page="waf-uc2-4">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            <span>UC2-4: Tier 1 Detections</span>
          </a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">MFA Project</div>
          <a href="mfa-overview.html" class="nav-item" data-page="mfa-overview">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            <span>Project Overview</span>
          </a>
          <a href="mfa-uc1.html" class="nav-item" data-page="mfa-uc1">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg>
            <span>UC1: MFA Fatigue</span>
          </a>
          <a href="mfa-uc2-5.html" class="nav-item" data-page="mfa-uc2-5">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg>
            <span>UC2-5: All MFA Detections</span>
          </a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="splunk-operations.html" class="nav-item active" data-page="splunk-operations">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4"/></svg>
            <span>Splunk Operations</span>
          </a>
          <a href="decision-trees.html" class="nav-item" data-page="decision-trees">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            <span>Decision Trees</span>
          </a>
          <a href="troubleshooting.html" class="nav-item" data-page="troubleshooting">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/></svg>
            <span>Troubleshooting</span>
          </a>
          <a href="runbooks.html" class="nav-item" data-page="runbooks">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg>
            <span>SOC Runbooks</span>
          </a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Reference</div>
          <a href="spl-reference.html" class="nav-item" data-page="spl-reference">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
            <span>SPL Reference</span>
          </a>
          <a href="glossary.html" class="nav-item" data-page="glossary">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
            <span>Glossary</span>
          </a>
        </div>
      </nav>
      <div class="sidebar-footer">
        <p>Version 2.0 — January 2026</p>
      </div>
    </aside>

    <main class="main-content">
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" aria-label="Toggle menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
          </button>
          <div class="breadcrumb">
            <a href="../index.html" class="breadcrumb-item">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item current">Splunk Operations Guide</span>
          </div>
        </div>
        <div class="header-right">
          <span class="badge splunk">6 Phases</span>
        </div>
      </header>

      <div class="page-content">
        <!-- Header -->
        <div class="section">
          <div class="section-header">
            <h1 class="section-title">Splunk Operations Guide</h1>
            <p class="section-subtitle">End-to-end workflow from log discovery to go-live</p>
          </div>
        </div>

        <!-- Process Overview -->
        <div class="section">
          <div class="card">
            <div class="code-block">
              <div class="code-header">
                <span class="code-title">End-to-End Process Flow</span>
              </div>
              <div class="code-body">
                <pre><code>┌─────────────────────────────────────────────────────────────────────────────┐
│  PHASE 1: DISCOVERY     →  PHASE 2: ONBOARDING  →  PHASE 3: VALIDATION     │
│  ─────────────────────     ──────────────────────   ────────────────────    │
│  • Identify log sources    • Install add-ons        • Verify data flowing   │
│  • Find indexes            • Configure inputs       • Check field extraction│
│  • Determine vendors       • Set up credentials     • Validate timestamps   │
│  • Check existing data     • Deploy configs         • Test CIM mapping      │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│  PHASE 4: PARSING       →  PHASE 5: USE CASES   →  PHASE 6: GO-LIVE        │
│  ─────────────────────     ──────────────────────   ────────────────────    │
│  • props.conf              • Develop SPL            • Enable alerts         │
│  • transforms.conf         • Create saved searches  • Configure actions     │
│  • Field aliases           • Build dashboards       • Monitor & tune        │
│  • Lookups                 • Write runbooks         • Handover              │
└─────────────────────────────────────────────────────────────────────────────┘</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 1: Discovery -->
        <div class="section" id="phase1">
          <div class="subsection">
            <h3 class="subsection-title">Phase 1: Log Discovery & Identification</h3>

            <div class="checklist" data-checklist-id="phase1-checklist">
              <div class="checklist-header">
                <div class="checklist-title">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                  Phase 1 Checklist
                </div>
                <span class="checklist-count">0/6</span>
              </div>
              <div class="checklist-progress">
                <div class="checklist-progress-bar" style="width: 0%"></div>
              </div>
              <div class="checklist-items">
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Run master discovery query to find all data sources</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Identify WAF index and sourcetype</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Identify CyberArk index and sourcetype</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Identify Entra ID index and sourcetype</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Document all relevant indexes in notes</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Confirm data freshness (&lt;1 hour latency)</span>
                </div>
              </div>
            </div>

            <div class="code-block" style="margin-top: 16px;">
              <div class="code-header">
                <span class="code-title">Master Discovery Query — Run This First</span>
              </div>
              <div class="code-body">
                <pre><code>``` Find all indexes and sourcetypes you have access to
| tstats count WHERE index=* BY index sourcetype 
| sort - count
| head 50

``` Find security-relevant indexes
| tstats count WHERE index=* BY index 
| search index IN (*security*, *waf*, *firewall*, *azure*, *aws*, *cloud*, *auth*, *identity*, *cyberark*, *akamai*, *cloudflare*)

``` Check data volume and freshness by index
| tstats count latest(_time) as last_event WHERE index=* earliest=-24h BY index
| eval hours_ago = round((now() - last_event) / 3600, 1)
| eval last_event = strftime(last_event, "%Y-%m-%d %H:%M:%S")
| sort - count
| head 30</code></pre>
              </div>
            </div>

            <div class="code-block">
              <div class="code-header">
                <span class="code-title">Find Akamai WAF Data</span>
              </div>
              <div class="code-body">
                <pre><code>``` Search for Akamai-specific data
index=* sourcetype=*akamai* earliest=-1h | stats count by index sourcetype

``` Alternative: Search for Akamai-specific fields
index=* (attackData.clientIP=* OR attackData.rules{}=*) earliest=-1h 
| stats count by index sourcetype
| head 10

``` If found, get sample event
index=akamai sourcetype=akamai:siem earliest=-1h | head 1 | table _raw</code></pre>
              </div>
            </div>

            <div class="code-block">
              <div class="code-header">
                <span class="code-title">Find CyberArk Data</span>
              </div>
              <div class="code-body">
                <pre><code>``` Search for CyberArk data
index=* sourcetype=*cyberark* earliest=-1h | stats count by index sourcetype

``` Alternative: Search for CyberArk-specific fields
index=* (EventType=*Mfa* OR ActorId=*) earliest=-1h 
| stats count by index sourcetype
| head 10

``` If found, get sample event
index=cyberark sourcetype=cyberark:identity:audit earliest=-1h | head 1 | table _raw</code></pre>
              </div>
            </div>

            <div class="code-block">
              <div class="code-header">
                <span class="code-title">Find Entra ID Data</span>
              </div>
              <div class="code-body">
                <pre><code>``` Search for Azure/Entra ID data
index=* sourcetype=*azure* earliest=-1h | stats count by index sourcetype

``` Search for sign-in logs specifically
index=* sourcetype=azure:aad:signin earliest=-1h | stats count

``` If found, get sample event
index=azure sourcetype=azure:aad:signin earliest=-1h | head 1 | table _raw</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 2: Onboarding -->
        <div class="section" id="phase2">
          <div class="subsection">
            <h3 class="subsection-title">Phase 2: Data Onboarding</h3>

            <div class="callout info">
              <svg class="callout-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
              <div class="callout-content">
                <div class="callout-title">Splunk Cloud Limitations</div>
                <div class="callout-body">In Splunk Cloud, you can't install apps directly. Submit a support ticket or use Cloud Console to request add-on installation.</div>
              </div>
            </div>

            <div class="table-container" style="margin-top: 16px;">
              <table>
                <thead>
                  <tr>
                    <th>Data Source</th>
                    <th>Required Add-on</th>
                    <th>Installation Method</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="highlight">Akamai WAF</td>
                    <td>Splunk Add-on for Akamai (TA-akamai)</td>
                    <td>Splunkbase → Cloud Console</td>
                    <td><input type="checkbox"> Installed</td>
                  </tr>
                  <tr>
                    <td class="highlight">CyberArk Identity</td>
                    <td>HEC or Syslog (native JSON)</td>
                    <td>Configure on CyberArk side</td>
                    <td><input type="checkbox"> Configured</td>
                  </tr>
                  <tr>
                    <td class="highlight">Microsoft Entra ID</td>
                    <td>Splunk Add-on for Microsoft Cloud Services</td>
                    <td>Splunkbase → Cloud Console</td>
                    <td><input type="checkbox"> Installed</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Phase 3: Validation -->
        <div class="section" id="phase3">
          <div class="subsection">
            <h3 class="subsection-title">Phase 3: Validation & Verification</h3>

            <div class="checklist" data-checklist-id="phase3-checklist">
              <div class="checklist-header">
                <div class="checklist-title">Phase 3 Checklist</div>
                <span class="checklist-count">0/5</span>
              </div>
              <div class="checklist-progress">
                <div class="checklist-progress-bar" style="width: 0%"></div>
              </div>
              <div class="checklist-items">
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Data is flowing (>0 events in last hour)</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Timestamp is correct (not future/past)</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Critical fields are extracting</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Latency is acceptable (&lt;10 min avg)</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">No parsing errors in _internal</span>
                </div>
              </div>
            </div>

            <div class="code-block" style="margin-top: 16px;">
              <div class="code-header">
                <span class="code-title">Validation Query Set — Run for Each Source</span>
              </div>
              <div class="code-body">
                <pre><code>``` 1. Check data is flowing
index=&lt;index_name&gt; earliest=-1h | stats count

``` 2. Check latest event time
index=&lt;index_name&gt; | head 1 | table _time _indextime _raw

``` 3. Check event count trend (should be steady)
index=&lt;index_name&gt; earliest=-24h 
| timechart span=1h count

``` 4. Check for indexing latency
index=&lt;index_name&gt; earliest=-1h
| eval latency_seconds = _indextime - _time
| stats avg(latency_seconds) as avg_latency max(latency_seconds) as max_latency
| eval avg_minutes = round(avg_latency/60, 1)
| eval max_minutes = round(max_latency/60, 1)

``` 5. Check field extraction quality
index=&lt;index_name&gt; earliest=-1h
| head 1000
| fieldsummary
| where count > 0
| table field count distinct_count</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 4: Parsing -->
        <div class="section" id="phase4">
          <div class="subsection">
            <h3 class="subsection-title">Phase 4: Parsing & Configuration</h3>

            <p style="margin-bottom: 16px; color: var(--gray-600);">Required configuration files for proper field extraction and CIM mapping:</p>

            <div class="grid grid-2">
              <div class="card">
                <h4 style="margin-bottom: 8px;">props.conf</h4>
                <p style="font-size: 0.875rem; color: var(--gray-600);">Defines timestamp, field extraction, and calculated fields. See vendor pages for complete configs.</p>
              </div>
              <div class="card">
                <h4 style="margin-bottom: 8px;">transforms.conf</h4>
                <p style="font-size: 0.875rem; color: var(--gray-600);">Defines lookup table references used in detections.</p>
              </div>
            </div>

            <div class="code-block" style="margin-top: 16px;">
              <div class="code-header">
                <span class="code-title">transforms.conf for Lookups</span>
              </div>
              <div class="code-body">
                <pre><code>[privileged_users_lookup]
filename = privileged_users.csv
case_sensitive_match = false

[sensitive_endpoints_lookup]
filename = sensitive_endpoints.csv
case_sensitive_match = false

[high_risk_countries_lookup]
filename = high_risk_countries.csv

[waf_allowlist_lookup]
filename = waf_allowlist.csv
case_sensitive_match = false</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 5: Use Case Development -->
        <div class="section" id="phase5">
          <div class="subsection">
            <h3 class="subsection-title">Phase 5: Use Case Development</h3>

            <div class="checklist" data-checklist-id="phase5-checklist">
              <div class="checklist-header">
                <div class="checklist-title">Per-Detection Checklist</div>
                <span class="checklist-count">0/10</span>
              </div>
              <div class="checklist-progress">
                <div class="checklist-progress-bar" style="width: 0%"></div>
              </div>
              <div class="checklist-items">
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Threat intent and MITRE ATT&CK mapping documented</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Data dependencies validated (fields exist and extract)</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">SPL runs correctly and returns expected results</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Baseline established with 14+ days of data</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Threshold rationale documented</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">False positive analysis completed</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Allowlist created (if applicable)</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">SOC runbook written</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Search performance &lt;30 seconds</span>
                </div>
                <div class="checklist-item">
                  <input type="checkbox" class="checklist-checkbox">
                  <span class="checklist-text">Test cases executed and passed</span>
                </div>
              </div>
            </div>

            <div class="code-block" style="margin-top: 16px;">
              <div class="code-header">
                <span class="code-title">savedsearches.conf Example</span>
              </div>
              <div class="code-body">
                <pre><code>[WAF-UC1 - WAF Block Volume Anomaly]
search = index=akamai sourcetype=akamai:siem \
| spath path=attackData.rules{}.ruleAction output=action \
| where action="deny" \
| bin _time span=5m \
| stats count as block_count dc(attackData.clientIP) as unique_ips BY _time \
| eventstats avg(block_count) as baseline stdev(block_count) as stdev \
| eval threshold = baseline + (2 * stdev) \
| where block_count > threshold AND block_count > 50 \
| eval deviation = round((block_count - baseline) / stdev, 2)

cron_schedule = */5 * * * *
dispatch.earliest_time = -10m
dispatch.latest_time = now
enableSched = 1
alert_type = number of events
alert_comparator = greater than
alert_threshold = 0
alert.suppress = 1
alert.suppress.period = 30m
alert.severity = 3
description = Detects anomalous spikes in WAF block volume indicating potential attack
disabled = 0</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 6: Go-Live -->
        <div class="section" id="phase6">
          <div class="subsection">
            <h3 class="subsection-title">Phase 6: Go-Live & Monitoring</h3>

            <div class="callout warning">
              <svg class="callout-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg>
              <div class="callout-content">
                <div class="callout-title">Phased Rollout Recommended</div>
                <div class="callout-body">Don't enable all detections at once. Use a phased approach over 4 weeks.</div>
              </div>
            </div>

            <div class="timeline" style="margin-top: 16px;">
              <div class="timeline-item">
                <div class="timeline-content">
                  <h4 class="timeline-title">Week 1: Silent Mode</h4>
                  <p class="timeline-body">Enable detections in "log only" mode (no alerts). Monitor search results daily. Track false positive candidates.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-content">
                  <h4 class="timeline-title">Week 2: Limited Alerting</h4>
                  <p class="timeline-body">Enable alerting for CRITICAL severity only. Limited distribution (security team only). Tune based on feedback.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-content">
                  <h4 class="timeline-title">Week 3: Full Alerting</h4>
                  <p class="timeline-body">Enable all severity levels. Full SOC distribution. Document tuning changes.</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-content">
                  <h4 class="timeline-title">Week 4: Stabilization & Handover</h4>
                  <p class="timeline-body">Final tuning. Documentation update. Knowledge transfer. Handover to SOC.</p>
                </div>
              </div>
            </div>

            <div class="code-block" style="margin-top: 16px;">
              <div class="code-header">
                <span class="code-title">Go-Live Monitoring Queries</span>
              </div>
              <div class="code-body">
                <pre><code>``` Monitor alert volume by detection
index=_audit action=alert_fired
| stats count BY savedsearch_name
| sort - count

``` Monitor search performance
index=_internal sourcetype=scheduler status=success
| stats avg(run_time) as avg_runtime max(run_time) as max_runtime BY savedsearch_name
| where avg_runtime > 30
| sort - avg_runtime

``` Check for skipped searches (schedule conflicts)
index=_internal sourcetype=scheduler status=skipped
| stats count BY savedsearch_name
| sort - count

``` Alert timing analysis
index=_audit action=alert_fired savedsearch_name="WAF-UC*" OR savedsearch_name="MFA-UC*"
| timechart span=1h count BY savedsearch_name</code></pre>
              </div>
            </div>
          </div>
        </div>

        <!-- Splunk Cloud Limitations -->
        <div class="section">
          <div class="subsection">
            <h3 class="subsection-title">Splunk Cloud Limitations & Workarounds</h3>

            <div class="table-container">
              <table>
                <thead>
                  <tr>
                    <th>Limitation</th>
                    <th>Workaround</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="highlight">Can't create indexes</td>
                    <td>Submit support ticket to Splunk Cloud team</td>
                  </tr>
                  <tr>
                    <td class="highlight">Can't install any app</td>
                    <td>Request via Cloud Console or support ticket</td>
                  </tr>
                  <tr>
                    <td class="highlight">Can't edit props.conf directly</td>
                    <td>Package in custom app, deploy via Cloud Console</td>
                  </tr>
                  <tr>
                    <td class="highlight">Limited concurrent searches</td>
                    <td>Optimize queries, use summary indexing</td>
                  </tr>
                  <tr>
                    <td class="highlight">No file system access</td>
                    <td>Use REST API or Cloud Console</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

      </div>
    </main>
  </div>

  <script src="../js/app.js"></script>
</body>
</html>
