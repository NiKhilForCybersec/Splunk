<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SOC Runbooks | myfirstpro Detection Engineering</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <div class="app-container">
                                                    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <a href="../index.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit;">
            <div class="sidebar-logo-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            </div>
            <div class="sidebar-logo-text">
              <h1>Splunk Reference</h1>
              <span>Log & Detection Engineering</span>
            </div>
          </a>
        </div>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Getting Started</div>
          <a href="../index.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span>Command Center</span></a>
          <a href="day1.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/></svg><span>Day 1 Checklist</span></a>
          <a href="professional-excellence.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg><span>Professional Excellence</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Client Delivery</div>
          <a href="client-delivery.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg><span>Delivery Playbook</span></a>
          <a href="detection-template.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>Use Case Template</span></a>
          <a href="rba-design.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg><span>RBA Design Guide</span></a>
          <a href="cim-mapping.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg><span>CIM Mapping Guide</span></a>
          <a href="es-mechanics.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg><span>ES Mechanics</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Splunk Platform</div>
          <a href="splunk-fundamentals.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>Splunk 101</span></a>
          <a href="splunk-architecture.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg><span>Architecture</span></a>
          <a href="splunk-apps.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg><span>Apps & Add-ons</span></a>
          <a href="splunk-es.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>Enterprise Security</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Log Engineering</div>
          <a href="log-onboarding.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span>Log Onboarding</span></a>
          <a href="data-inputs.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg><span>Data Inputs</span></a>
          <a href="data-flow.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg><span>Data Flow</span></a>
          <a href="parsing-cim.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg><span>Parsing & CIM</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">SPL Mastery</div>
          <a href="splunk-howto.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg><span>SPL How-To</span></a>
          <a href="spl-reference.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg><span>SPL Reference</span></a>
          <a href="lookups.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg><span>Lookups</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Detection Development</div>
          <a href="correlation-searches.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><span>Correlation Searches</span></a>
          <a href="detection-lifecycle.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg><span>Detection Lifecycle</span></a>
          <a href="decision-trees.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="3"/><line x1="12" y1="8" x2="12" y2="14"/><circle cx="6" cy="19" r="3"/><circle cx="18" cy="19" r="3"/></svg><span>Decision Trees</span></a>
          <a href="troubleshooting.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg><span>Troubleshooting</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Data Sources</div>
          <a href="vendor-akamai.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg><span>Akamai WAF</span></a>
          <a href="vendor-entra.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg><span>Entra ID</span></a>
          <a href="vendor-cyberark.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><span>CyberArk</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Active Projects</div>
          <a href="waf-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg><span>WAF/DDoS Project</span></a>
          <a href="waf-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>WAF Use Cases</span></a>
          <a href="mfa-overview.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg><span>MFA Project</span></a>
          <a href="mfa-usecases.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>MFA Use Cases</span></a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Operations</div>
          <a href="splunk-ops.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/></svg><span>Splunk Cloud Admin</span></a>
          <a href="client-comm.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg><span>Client Comms</span></a>
          <a href="runbooks.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/></svg><span>Runbooks</span></a>
          <a href="cheat-sheets.html" class="nav-item"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="3" x2="9" y2="21"/></svg><span>Cheat Sheets</span></a>
        </div>
      </nav>
      <div class="sidebar-footer"><p>Log & Detection Engineering v3.0</p></div>
    </aside>

    <main class="main-content">
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" aria-label="Toggle menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
          </button>
          <div class="breadcrumb">
            <a href="../index.html" class="breadcrumb-item">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item current">SOC Runbooks</span>
          </div>
        </div>
        <span class="badge info">13 Runbooks</span>
      </header>

      <div class="page-content">
        <div class="section">
          <h1 class="section-title">SOC Analyst Runbooks</h1>
          <p class="section-subtitle">Step-by-step response procedures for each detection alert</p>
        </div>


        <!-- Alert Response Flow -->
        <div class="section">
          <h2 class="subsection-title">Alert Response Flow</h2>
          <div class="card" style="padding:24px;background:var(--gray-50);overflow-x:auto;">
            <div class="mermaid">
flowchart LR
    A[Alert<br/>Received] --> B{Severity?}
    B -->|CRITICAL| C[5 min SLA]
    B -->|HIGH| D[15 min SLA]
    B -->|MEDIUM| E[1 hour SLA]
    
    C --> F[Immediate<br/>Containment]
    D --> G[Investigation]
    E --> G
    
    F --> H[Escalate to IR]
    G --> I{Confirmed<br/>Threat?}
    I -->|Yes| H
    I -->|No| J[Close as FP]
    
    style C fill:#f8d7da,stroke:#dc3545
    style F fill:#f8d7da,stroke:#dc3545
    style J fill:#d4edda,stroke:#28a745
            </div>
          </div>
        </div>


        <!-- Runbook Index -->
        <div class="section">
          <h2 class="subsection-title">Runbook Index</h2>
          <div class="grid grid-2">
            <div>
              <h4 style="margin-bottom:12px;">WAF/DDoS Runbooks</h4>
              <ul class="checklist">
                <li class="checklist-item"><a href="#waf-uc1">WAF-UC1: Block Volume Anomaly</a></li>
                <li class="checklist-item"><a href="#waf-uc2">WAF-UC2: Single Source Flood</a></li>
                <li class="checklist-item"><a href="#waf-uc3">WAF-UC3: Auth Endpoint Attack</a></li>
                <li class="checklist-item"><a href="#waf-uc4">WAF-UC4: SQLi/XSS Campaign</a></li>
              </ul>
            </div>
            <div>
              <h4 style="margin-bottom:12px;">MFA Runbooks</h4>
              <ul class="checklist">
                <li class="checklist-item"><a href="#mfa-uc1">MFA-UC1: MFA Fatigue Attack</a></li>
                <li class="checklist-item"><a href="#mfa-uc2">MFA-UC2: Failure Burst → Success</a></li>
                <li class="checklist-item"><a href="#mfa-uc4">MFA-UC4: Impossible Travel</a></li>
              </ul>
            </div>
          </div>
        </div>

        <!-- WAF-UC1 Runbook -->
        <div class="section" id="waf-uc1">
          <h2 class="subsection-title">WAF-UC1: Block Volume Anomaly</h2>
          
          <div class="grid grid-4" style="margin-bottom:16px;">
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value warning" style="font-size:1rem;">Medium</div>
              <div class="stat-label">Severity</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">T1190</div>
              <div class="stat-label">MITRE</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">15 min</div>
              <div class="stat-label">SLA</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">Tier 1</div>
              <div class="stat-label">Responder</div>
            </div>
          </div>

          <div class="accordion">
            <div class="accordion-item open">
              <button class="accordion-header">
                <span>Step 1: Validate Alert (2 min)</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <ul style="font-size:0.875rem;color:var(--gray-600);margin-left:16px;">
                  <li>Open the alert in Incident Review</li>
                  <li>Review the deviation value (how many sigma above baseline)</li>
                  <li>Check if this matches a known maintenance window</li>
                  <li><strong>If deviation < 2:</strong> May be normal variance → Monitor</li>
                  <li><strong>If deviation ≥ 3:</strong> Likely real attack → Continue</li>
                </ul>
              </div>
            </div>

            <div class="accordion-item">
              <button class="accordion-header">
                <span>Step 2: Identify Attack Pattern (5 min)</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <div class="code-block">
                  <div class="code-header"><span class="code-title">Drilldown Query</span></div>
                  <div class="code-body">
                    <pre><code>index=akamai sourcetype=akamai:siem earliest=-1h
| spath path=attackData.rules{}.ruleAction output=action
| where action="deny"
| stats count as blocks 
        dc(attackData.clientIP) as unique_ips
        values(attackData.rules{}.ruleTag) as attack_types
        BY httpMessage.requestHeaders.Host
| sort - blocks</code></pre>
                  </div>
                </div>
                <p style="font-size:0.875rem;color:var(--gray-600);margin-top:12px;">
                  <strong>Questions to answer:</strong> Single host or multiple? Single IP or distributed? What attack types?
                </p>
              </div>
            </div>

            <div class="accordion-item">
              <button class="accordion-header">
                <span>Step 3: Check for Scanner FP (3 min)</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <ul style="font-size:0.875rem;color:var(--gray-600);margin-left:16px;">
                  <li>Check top source IPs against scanner allowlist</li>
                  <li>Look for Qualys, Tenable, Nessus user agents</li>
                  <li>Check if activity correlates with scan schedule</li>
                  <li><strong>If scanner FP:</strong> Close as False Positive, add to exclusion</li>
                </ul>
              </div>
            </div>

            <div class="accordion-item">
              <button class="accordion-header">
                <span>Step 4: Escalate if Needed</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <div class="grid grid-2">
                  <div class="card bordered-left warning">
                    <h4>Escalate to Tier 2 if:</h4>
                    <ul style="font-size:0.8125rem;color:var(--gray-600);margin-left:16px;">
                      <li>Coordinated multi-IP attack</li>
                      <li>Critical application targeted</li>
                      <li>SQLi/XSS attack types detected</li>
                      <li>Block volume continues increasing</li>
                    </ul>
                  </div>
                  <div class="card bordered-left error">
                    <h4>Escalate to IR if:</h4>
                    <ul style="font-size:0.8125rem;color:var(--gray-600);margin-left:16px;">
                      <li>Evidence of successful exploitation</li>
                      <li>Application errors correlated with attacks</li>
                      <li>Sustained attack > 1 hour</li>
                      <li>Customer-facing impact</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- MFA-UC1 Runbook -->
        <div class="section" id="mfa-uc1">
          <h2 class="subsection-title">MFA-UC1: MFA Fatigue Attack</h2>
          
          <div class="callout critical">
            <svg class="callout-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg>
            <div class="callout-content">
              <div class="callout-title">⚠️ Time-Critical Alert</div>
              <div class="callout-body">This attack may result in account compromise. Respond within 5 minutes. If CRITICAL severity (denials + success), assume account is compromised.</div>
            </div>
          </div>

          <div class="grid grid-4" style="margin-bottom:16px;">
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value critical" style="font-size:1rem;">Critical</div>
              <div class="stat-label">Severity</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">T1621</div>
              <div class="stat-label">MITRE</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value error" style="font-size:1rem;">5 min</div>
              <div class="stat-label">SLA</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">Tier 1+IR</div>
              <div class="stat-label">Responder</div>
            </div>
          </div>

          <div class="accordion">
            <div class="accordion-item open">
              <button class="accordion-header">
                <span>Step 1: Check Alert Severity (1 min)</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <div class="grid grid-2">
                  <div class="card bordered-left error">
                    <h4>HIGH Severity</h4>
                    <p style="font-size:0.8125rem;color:var(--gray-600);">
                      5+ denials, NO success<br>
                      <strong>Status:</strong> Attack in progress<br>
                      <strong>Action:</strong> Contact user immediately
                    </p>
                  </div>
                  <div class="card bordered-left critical">
                    <h4>CRITICAL Severity</h4>
                    <p style="font-size:0.8125rem;color:var(--gray-600);">
                      5+ denials THEN success<br>
                      <strong>Status:</strong> Likely compromised<br>
                      <strong>Action:</strong> Lock account NOW
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <div class="accordion-item">
              <button class="accordion-header">
                <span>Step 2: CRITICAL - Immediate Containment (2 min)</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <p style="font-size:0.875rem;color:var(--gray-600);font-weight:600;color:var(--error-600);">If severity = CRITICAL (success after denials):</p>
                <ol style="font-size:0.875rem;color:var(--gray-600);margin-left:20px;margin-top:8px;">
                  <li><strong>Disable account</strong> in CyberArk Identity immediately</li>
                  <li><strong>Revoke all active sessions</strong> in CyberArk and Entra ID</li>
                  <li><strong>Reset password</strong> (user will need new one)</li>
                  <li><strong>Notify IR team</strong> for investigation</li>
                  <li>Document timeline of events</li>
                </ol>
              </div>
            </div>

            <div class="accordion-item">
              <button class="accordion-header">
                <span>Step 3: HIGH - Contact User (3 min)</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <p style="font-size:0.875rem;color:var(--gray-600);">If severity = HIGH (denials only, no success yet):</p>
                <ol style="font-size:0.875rem;color:var(--gray-600);margin-left:20px;margin-top:8px;">
                  <li><strong>Call user directly</strong> (phone, not email/chat)</li>
                  <li>Ask: "Are you trying to log in right now?"</li>
                  <li><strong>If NO:</strong> Attacker has credentials → Reset password immediately</li>
                  <li><strong>If YES:</strong> Verify their location and device → May be legitimate</li>
                  <li>Warn user to deny any unexpected MFA prompts</li>
                </ol>
              </div>
            </div>

            <div class="accordion-item">
              <button class="accordion-header">
                <span>Step 4: Investigation Queries</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <div class="code-block">
                  <div class="code-header"><span class="code-title">User Activity Timeline</span></div>
                  <div class="code-body">
                    <pre><code>index=cyberark sourcetype=cyberark:identity:audit earliest=-24h
    ActorId="affected_user@myfirstpro.com"
| sort _time
| table _time EventType Result ClientIP City Country AuthMethod</code></pre>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header"><span class="code-title">Check for Post-Compromise Activity</span></div>
                  <div class="code-body">
                    <pre><code>index=cyberark sourcetype=cyberark:identity:audit earliest=-1h
    ActorId="affected_user@myfirstpro.com" Result="Success"
| stats count values(EventType) as activities values(TargetId) as applications BY ClientIP</code></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- MFA-UC4 Runbook -->
        <div class="section" id="mfa-uc4">
          <h2 class="subsection-title">MFA-UC4: Impossible Travel</h2>
          
          <div class="grid grid-4" style="margin-bottom:16px;">
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value error" style="font-size:1rem;">High</div>
              <div class="stat-label">Severity</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">T1078</div>
              <div class="stat-label">MITRE</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">10 min</div>
              <div class="stat-label">SLA</div>
            </div>
            <div class="card stat-card" style="padding:12px;">
              <div class="stat-value" style="font-size:1rem;">Tier 1</div>
              <div class="stat-label">Responder</div>
            </div>
          </div>

          <div class="accordion">
            <div class="accordion-item open">
              <button class="accordion-header">
                <span>Step 1: Verify the Alert</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <p style="font-size:0.875rem;color:var(--gray-600);">Check the distance and time values:</p>
                <ul style="font-size:0.875rem;color:var(--gray-600);margin-left:16px;">
                  <li><strong>Speed > 800 km/h:</strong> Faster than commercial flight = suspicious</li>
                  <li><strong>Speed > 500 km/h with short time:</strong> Very suspicious</li>
                  <li><strong>VPN False Positive:</strong> Check if user commonly uses VPN</li>
                </ul>
              </div>
            </div>

            <div class="accordion-item">
              <button class="accordion-header">
                <span>Step 2: Contact User</span>
                <svg class="accordion-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
              </button>
              <div class="accordion-content">
                <ul style="font-size:0.875rem;color:var(--gray-600);margin-left:16px;">
                  <li>Ask: "Did you log in from [City A] and [City B] today?"</li>
                  <li>Ask: "Are you traveling or using a VPN?"</li>
                  <li><strong>If confirmed VPN:</strong> Document and close as FP</li>
                  <li><strong>If not:</strong> Reset password and escalate to IR</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

      
        <!-- HOW TO ADD EXCLUSIONS -->
        <div class="section" style="margin-top:48px;border-top:2px solid var(--gray-200);padding-top:32px;">
          <h2 class="subsection-title">How to Add Exclusions/Whitelists</h2>
          <p style="color:var(--gray-600);margin-bottom:24px;">When investigation reveals a false positive, you need to add an exclusion. Here's exactly how to do it.</p>
          
          <!-- Method 1: Lookup-based exclusion -->
          <div class="card" style="padding:24px;margin-bottom:20px;">
            <h3 style="font-size:1.125rem;margin-bottom:16px;color:var(--primary-600);">Method 1: Add to Exclusion Lookup (Recommended)</h3>
            <p style="font-size:0.875rem;color:var(--gray-600);margin-bottom:16px;">Best for: IPs, users, or hostnames that should be permanently excluded</p>
            
            <h4 style="font-size:0.9375rem;margin-bottom:12px;">Step-by-Step:</h4>
            <div class="table-container">
              <table>
                <thead><tr><th style="width:40px;">#</th><th>Action</th><th>What to Enter</th></tr></thead>
                <tbody>
                  <tr><td class="highlight">1</td><td>Go to <strong>Settings → Lookups → Lookup table files</strong></td><td>—</td></tr>
                  <tr><td class="highlight">2</td><td>Find the exclusion lookup (e.g., <code>waf_exclusions.csv</code>)</td><td>—</td></tr>
                  <tr><td class="highlight">3</td><td>Click the lookup name to edit</td><td>—</td></tr>
                  <tr><td class="highlight">4</td><td>Add a new row with the exclusion details</td><td>See format below</td></tr>
                  <tr><td class="highlight">5</td><td>Click <strong>"Save"</strong></td><td>—</td></tr>
                </tbody>
              </table>
            </div>
            
            <h4 style="font-size:0.9375rem;margin:16px 0 8px;">Example Exclusion Lookup Format:</h4>
            <div class="code-block">
              <div class="code-header"><span class="code-title">waf_exclusions.csv</span></div>
              <div class="code-body">
                <pre><code>src_ip,reason,added_by,added_date,ticket,expiry_date
10.1.50.100,Qualys scanner - scheduled scans,jsmith,2024-01-15,INC0012345,2025-01-15
192.168.1.50,Internal load balancer health checks,jsmith,2024-01-15,CHG0067890,never</code></pre>
              </div>
            </div>
            
            <h4 style="font-size:0.9375rem;margin:16px 0 8px;">Alternative: Add via SPL (if you have write access)</h4>
            <div class="code-block">
              <div class="code-body">
                <pre><code>| makeresults 
| eval src_ip="10.1.50.100", reason="Qualys scanner", added_by="jsmith", added_date=strftime(now(),"%Y-%m-%d"), ticket="INC0012345", expiry_date="2025-01-15"
| outputlookup append=t waf_exclusions.csv</code></pre>
              </div>
            </div>
          </div>

          <!-- Method 2: Edit the SPL directly -->
          <div class="card" style="padding:24px;margin-bottom:20px;">
            <h3 style="font-size:1.125rem;margin-bottom:16px;color:var(--warning-600);">Method 2: Edit Detection SPL Directly (Quick Fix)</h3>
            <p style="font-size:0.875rem;color:var(--gray-600);margin-bottom:16px;">Use only if lookup method isn't set up. Not recommended for permanent exclusions.</p>
            
            <div class="table-container">
              <table>
                <thead><tr><th style="width:40px;">#</th><th>Action</th><th>Details</th></tr></thead>
                <tbody>
                  <tr><td class="highlight">1</td><td>Go to <strong>Settings → Searches, reports, and alerts</strong></td><td>—</td></tr>
                  <tr><td class="highlight">2</td><td>Find the detection (e.g., "WAF-UC1 Block Volume")</td><td>Use search filter</td></tr>
                  <tr><td class="highlight">3</td><td>Click <strong>Edit → Edit Search</strong></td><td>—</td></tr>
                  <tr><td class="highlight">4</td><td>Add exclusion line to SPL</td><td>See example below</td></tr>
                  <tr><td class="highlight">5</td><td>Save</td><td>—</td></tr>
                </tbody>
              </table>
            </div>
            
            <div class="code-block" style="margin-top:12px;">
              <div class="code-header"><span class="code-title">Adding Exclusion to SPL</span></div>
              <div class="code-body">
                <pre><code>index=akamai action=deny earliest=-5m
| where NOT src_ip IN ("10.1.50.100", "10.1.50.101")  ``` ADD THIS LINE
| stats count as block_count by src_ip
| where block_count > 100
...</code></pre>
              </div>
            </div>
            
            <div class="callout warning" style="margin-top:12px;">
              <div class="callout-content">
                <div class="callout-title">⚠️ Always Document Exclusions</div>
                <div class="callout-body">Add a comment in the SPL explaining WHY: <code>``` Excluded: 10.1.50.100 = Qualys scanner per INC0012345</code></div>
              </div>
            </div>
          </div>

          <!-- Method 3: ES Notable Suppression -->
          <div class="card" style="padding:24px;margin-bottom:20px;">
            <h3 style="font-size:1.125rem;margin-bottom:16px;color:var(--success-600);">Method 3: ES Notable Suppression (If Using Enterprise Security)</h3>
            
            <div class="table-container">
              <table>
                <thead><tr><th style="width:40px;">#</th><th>Action</th><th>Details</th></tr></thead>
                <tbody>
                  <tr><td class="highlight">1</td><td>Open the Notable Event in Incident Review</td><td>—</td></tr>
                  <tr><td class="highlight">2</td><td>Click <strong>"Suppress"</strong> in the Notable actions</td><td>Top right of Notable panel</td></tr>
                  <tr><td class="highlight">3</td><td>Set suppression criteria</td><td>e.g., src_ip=10.1.50.100</td></tr>
                  <tr><td class="highlight">4</td><td>Set expiration (or "Never")</td><td>—</td></tr>
                  <tr><td class="highlight">5</td><td>Enter reason</td><td>e.g., "Qualys scanner - INC0012345"</td></tr>
                  <tr><td class="highlight">6</td><td>Save</td><td>—</td></tr>
                </tbody>
              </table>
            </div>
            
            <p style="font-size:0.875rem;color:var(--gray-600);margin-top:12px;">
              <strong>View existing suppressions:</strong> <code>Enterprise Security → Configure → Content → Notable Event Suppressions</code>
            </p>
          </div>

          <!-- Best Practices -->
          <div class="callout info">
            <div class="callout-content">
              <div class="callout-title">Exclusion Best Practices</div>
              <div class="callout-body">
                ✅ <strong>Always document:</strong> Who added it, why, ticket number, expiry date<br>
                ✅ <strong>Use lookups:</strong> Easier to manage than editing SPL<br>
                ✅ <strong>Set expiry dates:</strong> Scanner IPs change, temporary exclusions should expire<br>
                ✅ <strong>Review quarterly:</strong> Remove stale exclusions<br>
                ❌ <strong>Never exclude broadly:</strong> Don't exclude entire subnets without good reason
              </div>
            </div>
          </div>
        </div>

        <!-- GO-LIVE CHECKLIST & HANDOFF RISKS -->
        <div class="section" style="margin-top:48px;border-top:2px solid var(--gray-200);padding-top:32px;">
          <h2 class="subsection-title" style="color:var(--warning-600);">⚠️ Go-Live Checklist & Handoff Risks</h2>
          
          <h3 style="font-size:1rem;margin-bottom:12px;">Pre-Go-Live Risks</h3>
          <div class="table-container">
            <table>
              <thead><tr><th>Risk</th><th>Consequence</th><th>Prevention</th></tr></thead>
              <tbody>
                <tr><td class="highlight">SOC not trained</td><td>Alerts ignored, mishandled</td><td>Training sessions before go-live</td></tr>
                <tr><td class="highlight">No ownership defined</td><td>Detections become stale</td><td>RACI matrix with named owners</td></tr>
                <tr><td class="highlight">Incomplete runbooks</td><td>Inconsistent response</td><td>SOC reviews all runbooks</td></tr>
                <tr><td class="highlight">Undocumented exclusions</td><td>FPs after you leave</td><td>Document all whitelists with rationale</td></tr>
                <tr><td class="highlight">No tuning process</td><td>FP rate increases</td><td>Define tuning SOP, schedule reviews</td></tr>
                <tr><td class="highlight">Lookup data stale</td><td>Privileged list outdated</td><td>Automated refresh, owner assigned</td></tr>
                <tr><td class="highlight">No hypercare</td><td>Issues unaddressed</td><td>Define 2-week hypercare period</td></tr>
              </tbody>
            </table>
          </div>

          <h3 style="font-size:1rem;margin:24px 0 12px;">Go-Live Checklist</h3>
          <div class="card bordered-left success" style="padding:16px;">
            <p style="font-size:0.875rem;color:var(--gray-600);margin-bottom:12px;"><strong>Do not enable production alerts until ALL items are checked:</strong></p>
            <div style="columns:2;font-size:0.875rem;column-gap:24px;">
              <p style="margin:4px 0;">☐ Silent mode 7+ days complete</p>
              <p style="margin:4px 0;">☐ FP rate < 10% for all detections</p>
              <p style="margin:4px 0;">☐ Runbooks complete and reviewed</p>
              <p style="margin:4px 0;">☐ SOC team trained</p>
              <p style="margin:4px 0;">☐ Alert routing configured</p>
              <p style="margin:4px 0;">☐ Escalation paths documented</p>
              <p style="margin:4px 0;">☐ Detection owners assigned</p>
              <p style="margin:4px 0;">☐ Lookup refresh scheduled</p>
              <p style="margin:4px 0;">☐ Tuning process documented</p>
              <p style="margin:4px 0;">☐ Hypercare period agreed (2 weeks)</p>
              <p style="margin:4px 0;">☐ All docs in client's repository</p>
              <p style="margin:4px 0;">☐ Knowledge transfer scheduled</p>
            </div>
          </div>

          <h3 style="font-size:1rem;margin:24px 0 12px;">Ownership Questions (Get Answers!)</h3>
          <div class="table-container">
            <table>
              <thead><tr><th>Responsibility</th><th>Owner</th><th>If Not Defined...</th></tr></thead>
              <tbody>
                <tr><td class="highlight">Ongoing tuning (FP reduction)</td><td>_______________</td><td>Alerts become noisy, ignored</td></tr>
                <tr><td class="highlight">Adding exclusions/whitelists</td><td>_______________</td><td>FPs accumulate</td></tr>
                <tr><td class="highlight">New use case requests</td><td>_______________</td><td>No one builds them</td></tr>
                <tr><td class="highlight">Detection failures</td><td>_______________</td><td>Alerts stop, no one notices</td></tr>
                <tr><td class="highlight">Runbook updates</td><td>_______________</td><td>SOC follows outdated procedures</td></tr>
                <tr><td class="highlight">Lookup maintenance</td><td>_______________</td><td>Data becomes stale</td></tr>
              </tbody>
            </table>
          </div>

          <div class="callout info" style="margin-top:16px;">
            <div class="callout-content">
              <div class="callout-title">Hypercare Period</div>
              <div class="callout-body">
                Recommend <strong>2 weeks minimum</strong> after go-live where you remain available for:<br>
                • Threshold adjustments<br>
                • Additional exclusions<br>
                • Runbook clarifications<br>
                • SOC questions<br>
                Document support model (email? Slack? On-call?)
              </div>
            </div>
          </div>
        </div>

      
        <!-- SITE FOOTER -->
        <footer style="margin-top:48px;padding:24px;background:var(--gray-100);border-radius:8px;text-align:center;font-size:0.85rem;color:var(--gray-600);">
          <div style="margin-bottom:8px;">
            <strong>Splunk Detection Engineering Reference</strong> | Version 2.0 | Last Updated: February 2, 2026
          </div>
          <div>
            Internal Use Only | Detection Engineering Team
          </div>
        </footer>

      </div>
    </main>
  </div>
  <script src="../js/app.js"></script>
  <script>mermaid.initialize({startOnLoad:true, theme:'neutral'});</script>
</body>
</html>
